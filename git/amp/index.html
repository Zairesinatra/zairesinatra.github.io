<!DOCTYPE html>
<html ⚡>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <title>Git</title>

    <meta name="description" content="撷英采华 —— Git 从炼气到大乘" />
    <link rel="icon" href="../../content/images/size/w256h256/2021/07/ghost-orb.png" type="image/png" />
    <link rel="canonical" href="../index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="zairesinatra" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Git" />
    <meta property="og:description" content="撷英采华 —— Git 从炼气到大乘" />
    <meta property="og:url" content="https://zairesinatra.github.io//git/" />
    <meta property="og:image" content="https://zairesinatra.github.io//content/images/2021/09/githubbg.jpg" />
    <meta property="article:published_time" content="2020-07-18T14:02:00.000Z" />
    <meta property="article:modified_time" content="2023-03-31T21:44:25.000Z" />
    <meta property="article:tag" content="Technology growth" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Git" />
    <meta name="twitter:description" content="撷英采华 —— Git 从炼气到大乘" />
    <meta name="twitter:url" content="https://zairesinatra.github.io//git/" />
    <meta name="twitter:image" content="https://zairesinatra.github.io//content/images/2021/09/githubbg.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Ziyi Xie" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Technology growth" />
    <meta name="twitter:site" content="@xieziyi0422" />
    <meta property="og:image:width" content="1920" />
    <meta property="og:image:height" content="1080" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "zairesinatra",
        "url": "https://zairesinatra.github.io//",
        "logo": {
            "@type": "ImageObject",
            "url": "https://zairesinatra.github.io//content/images/2021/07/zs-1.JPG",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Ziyi Xie",
        "image": {
            "@type": "ImageObject",
            "url": "https://zairesinatra.github.io//content/images/2021/07/zs-2.JPG",
            "width": 1079,
            "height": 1079
        },
        "url": "https://zairesinatra.github.io//author/ziyi/",
        "sameAs": []
    },
    "headline": "Git",
    "url": "https://zairesinatra.github.io//git/",
    "datePublished": "2020-07-18T14:02:00.000Z",
    "dateModified": "2023-03-31T21:44:25.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://zairesinatra.github.io//content/images/2021/09/githubbg.jpg",
        "width": 1920,
        "height": 1080
    },
    "keywords": "Technology growth",
    "description": "撷英采华 —— Git 从炼气到大乘",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://zairesinatra.github.io//"
    }
}
    </script>

    <meta name="generator" content="Ghost 5.33" />
    <link rel="alternate" type="application/rss+xml" title="zairesinatra" href="../../rss/index.html" />

    <style amp-custom>
    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    html {
        overflow-x: hidden;
        overflow-y: scroll;
        font-size: 62.5%;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    body {
        min-height: 100vh;
        margin: 0;
        padding: 0;
        color: #3a4145;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        font-size: 1.7rem;
        line-height: 1.55em;
        font-weight: 400;
        font-style: normal;
        background: #fff;
        scroll-behavior: smooth;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    p,
    ul,
    ol,
    li,
    dl,
    dd,
    hr,
    pre,
    form,
    table,
    video,
    figure,
    figcaption,
    blockquote {
        margin: 0;
        padding: 0;
    }

    ul[class],
    ol[class] {
        padding: 0;
        list-style: none;
    }

    img {
        display: block;
        max-width: 100%;
    }

    input,
    button,
    select,
    textarea {
        font: inherit;
        -webkit-appearance: none;
    }

    fieldset {
        margin: 0;
        padding: 0;
        border: 0;
    }

    label {
        display: block;
        font-size: 0.9em;
        font-weight: 700;
    }

    hr {
        position: relative;
        display: block;
        width: 100%;
        height: 1px;
        border: 0;
        border-top: 1px solid currentcolor;
        opacity: 0.1;
    }

    ::selection {
        text-shadow: none;
        background: #cbeafb;
    }

    mark {
        background-color: #fdffb6;
    }

    small {
        font-size: 80%;
    }

    sub,
    sup {
        position: relative;
        font-size: 75%;
        line-height: 0;
        vertical-align: baseline;
    }
    sup {
        top: -0.5em;
    }
    sub {
        bottom: -0.25em;
    }

    ul li + li {
        margin-top: 0.6em;
    }

    a {
        color: var(--ghost-accent-color, #1292EE);
        text-decoration-skip-ink: auto;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 0;
        font-weight: 700;
        color: #121212;
        line-height: 1.4em;
    }

    h1 {
        font-size: 3.4rem;
        line-height: 1.1em;
    }

    h2 {
        font-size: 2.4rem;
        line-height: 1.2em;
    }

    h3 {
        font-size: 1.8rem;
    }

    h4 {
        font-size: 1.7rem;
    }

    h5 {
        font-size: 1.6rem;
    }

    h6 {
        font-size: 1.6rem;
    }

    amp-img {
        height: 100%;
        width: 100%;
        max-width: 100%;
        max-height: 100%;
    }

    amp-img img {
        object-fit: cover;
    }
    
    amp-youtube {
        height: calc(100vw / 1.78);
        width: 100vw;
        position: relative;
    }

    amp-youtube img {
        position: absolute;
    }

    .page-header {
        padding: 50px 5vmin 30px;
        text-align: center;
        font-size: 2rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .page-header a {
        color: #121212;
        font-weight: 700;
        text-decoration: none;
        font-size: 1.6rem;
        letter-spacing: -0.1px;
    }

    .post {
        max-width: 680px;
        margin: 0 auto;
    }

    .post-header {
        margin: 0 5vmin 5vmin;
        text-align: center;
    }

    .post-meta {
        margin: 1rem 0 0 0;
        text-transform: uppercase;
        color: #738a94;
        font-weight: 500;
        font-size: 1.3rem;
    }

    .post-image {
        margin: 0 0 5vmin;
    }

    .post-image img {
        display: block;
        width: 100%;
        height: auto;
    }

    .post-content {
        padding: 0 5vmin;
    }

    .post-content > * + * {
        margin-top: 1.5em;
    }

    .post-content [id]:not(:first-child) {
        margin: 2em 0 0;
    }

    .post-content > [id] + * {
        margin-top: 1rem;
    }

    .post-content [id] + .kg-card,
    .post-content blockquote + .kg-card {
        margin-top: 40px;
    }

    .post-content > ul,
    .post-content > ol,
    .post-content > dl {
        padding-left: 1.9em;
    }

    .post-content hr {
        margin-top: 40px;
    }

    .post .post-content hr + * {
        margin-top: 40px;
    }

    .post-content amp-img {
        background-color: #f8f8f8;
    }

    .post-content blockquote {
        position: relative;
        font-style: italic;
    }

    .post-content blockquote::before {
        content: "";
        position: absolute;
        left: -1.5em;
        top: 0;
        bottom: 0;
        width: 0.3rem;
        background: var(--ghost-accent-color, #1292EE);
    }

    .post-content blockquote.kg-blockquote-alt {
        font-size: 1.2em;
        font-style: italic;
        line-height: 1.6em;
        text-align: center;
        color: #738a94;
        padding: 0.75em 3em 1.25em;
    }

    .post-content blockquote.kg-blockquote-alt::before {
        display: none;
    }

    .post-content :not(.kg-card):not([id]) + .kg-card {
        margin-top: 40px;
    }

    .post-content .kg-card + :not(.kg-card) {
        margin-top: 40px;
    }

    .kg-card figcaption {
        padding: 1.5rem 1.5rem 0;
        text-align: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.4em;
        opacity: 0.6;
    }

    .kg-card figcaption strong {
        color: rgba(0,0,0,0.8);
    }

    .post-content :not(pre) code {
        vertical-align: middle;
        padding: 0.15em 0.4em 0.15em;
        border: #e1eaef 1px solid;
        font-weight: 400;
        font-size: 0.9em;
        line-height: 1em;
        color: #15171a;
        background: #f0f6f9;
        border-radius: 0.25em;
    }

    .post-content > pre {
        overflow: scroll;
        padding: 16px 20px;
        color: #fff;
        background: #1F2428;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0,0,0,.1), 0 0 1px rgba(0,0,0,.4);
    }

    .kg-embed-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
    }

    .kg-image-card img {
        margin: auto;
    }

    .kg-gallery-card + .kg-gallery-card {
        margin-top: 0.75em;
    }

    .kg-gallery-container {
        position: relative;
    }

    .kg-gallery-row {
        display: flex;
        flex-direction: row;
        justify-content: center;
    }

    .kg-gallery-image {
        width: 100%;
        height: 100%;
    }

    .kg-gallery-row:not(:first-of-type) {
        margin: 0.75em 0 0 0;
    }

    .kg-gallery-image:not(:first-of-type) {
        margin: 0 0 0 0.75em;
    }

    .kg-bookmark-card,
    .kg-bookmark-publisher {
        position: relative;
    }

    .kg-bookmark-container,
    .kg-bookmark-container:hover {
        display: flex;
        flex-wrap: wrap;
        flex-direction: row-reverse;
        color: currentColor;
        background: rgba(255,255,255,0.6);
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        text-decoration: none;
        border-radius: 3px;
        box-shadow: 0 2px 6px -2px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0, 0, 0, 0.4);
        overflow: hidden;
    }

    .kg-bookmark-content {
        flex-basis: 0;
        flex-grow: 999;
        padding: 20px;
        order: 1;
    }

    .kg-bookmark-title {
        font-weight: 600;
        font-size: 1.5rem;
        line-height: 1.3em;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        max-height: 45px;
        margin: 0.5em 0 0 0;
        font-size: 1.4rem;
        line-height: 1.55em;
        overflow: hidden;
        opacity: 0.8;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .kg-bookmark-metadata {
        margin-top: 20px;
    }

    .kg-bookmark-metadata {
        display: flex;
        align-items: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.3em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
    }

    .kg-bookmark-metadata amp-img {
        width: 18px;
        height: 18px;
        max-width: 18px;
        max-height: 18px;
        margin-right: 10px;
    }

    .kg-bookmark-thumbnail {
        display: flex;
        flex-basis: 20rem;
        flex-grow: 1;
        justify-content: flex-end;
    }

    .kg-bookmark-thumbnail amp-img {
        max-height: 200px;
    }

    .kg-bookmark-author {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    .kg-bookmark-publisher::before {
        content: "•";
        margin: 0 .5em;
    }

    .kg-toggle-card-icon {
        display: none;
    }

    .kg-toggle-content {
        margin-top: 0.8rem;
    }

    .kg-product-card-container {
        background: transparent;
        padding: 20px;
        width: 100%;
        border-radius: 5px;
        box-shadow: inset 0 0 0 1px rgb(124 139 154 / 25%);
    }

    .kg-product-card-description p {
        margin-top: 1.5em;
    }

    .kg-product-card-description ul {
        margin-left: 24px;
    }

    .kg-product-card-title {
        font-size: 1.9rem;
        font-weight: 700;
    }

    .kg-product-card-rating-star {
        height: 28px;
        width: 20px;
        margin-right: 2px;
    }

    .kg-product-card-rating-star svg {
    width: 16px;
    height: 16px;
    fill: currentColor;
    opacity: 0.15;
    }

    .kg-product-card-rating-active.kg-product-card-rating-star svg {
    opacity: 1;
    }

    .kg-nft-card-container {
        position: relative;
        display: flex;
        flex: auto;
        flex-direction: column;
        text-decoration: none;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        font-size: 1.4rem;
        font-weight: 400;
        box-shadow: 0 2px 6px -2px rgb(0 0 0 / 10%), 0 0 1px rgb(0 0 0 / 40%);
        width: 100%;
        max-width: 512px;
        color: #15212A;
        background: #fff;
        border-radius: 5px;
        transition: none;
        margin: 0 auto;
    }

    .kg-nft-metadata {
        padding: 2.0rem;
    }

    .kg-nft-image-container {
        position: relative;
    }

    .kg-nft-image {
        display: flex;
        border-radius: 5px 5px 0 0;
    }

    .kg-nft-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 20px;
    }

    .kg-nft-header h4.kg-nft-title {
        font-size: 1.9rem;
        font-weight: 700;
        margin: 0;
        color: #15212A;
    }

    .kg-nft-header amp-img {
        max-width: 114px;
        max-height: 26px;
    }

    .kg-nft-opensea-logo {
        margin-top: 2px;
        width: 100px;
    }

    .kg-nft-creator {
        font-family: inherit;
        color: #95A1AD;
    }

    .kg-nft-creator span {
        font-weight: 500;
        color: #15212A;
    }

    .kg-nft-card p.kg-nft-description {
        font-size: 1.4rem;
        line-height: 1.4em;
        margin: 2.0rem 0 0;
        color: #222;
    }

    .kg-button-card {
        display: flex;
        position: static;
        align-items: center;
        width: 100%;
        justify-content: center;
    }

    .kg-btn {
        display: flex;
        position: static;
        align-items: center;
        padding: 0 2.0rem;
        height: 4.0rem;
        line-height: 4.0rem;
        font-size: 1.65rem;
        font-weight: 600;
        text-decoration: none;
        border-radius: 5px;
        transition: opacity 0.2s ease-in-out;
    }

    .kg-btn:hover {
        opacity: 0.85;
    }

    .kg-btn-accent {
        background-color: var(--ghost-accent-color, #1292EE);
        color: #fff;
    }

    .kg-callout-card {
        display: flex;
        padding: 20px 28px;
        border-radius: 3px;
    }

    .kg-callout-card-grey {
        background: rgba(124, 139, 154, 0.13);
    }

    .kg-callout-card-white {
        background: transparent;
        box-shadow: inset 0 0 0 1px rgba(124, 139, 154, 0.25);
    }

    .kg-callout-card-blue {
        background: rgba(33, 172, 232, 0.12);
    }

    .kg-callout-card-green {
        background: rgba(52, 183, 67, 0.12);
    }

    .kg-callout-card-yellow {
        background: rgba(240, 165, 15, 0.13);
    }

    .kg-callout-card-red {
        background: rgba(209, 46, 46, 0.11);
    }

    .kg-callout-card-pink {
        background: rgba(225, 71, 174, 0.11);
    }

    .kg-callout-card-purple {
        background: rgba(135, 85, 236, 0.12);
    }

    .kg-callout-card-accent {
        background: var(--ghost-accent-color);
        color: #fff;
    }

    .kg-callout-card-accent a {
        color: #fff;
    }

    .kg-callout-emoji {
        padding-right: 16px;
        line-height: 1.3;
        font-size: 1.25em;
    }

    .kg-header-card {
        padding: 6em 3em;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
    }

    .kg-header-card.kg-size-small {
        padding-top: 4em;
        padding-bottom: 4em;
    }

    .kg-header-card.kg-size-large {
        padding-top: 12em;
        padding-bottom: 12em;
    }

    .kg-header-card.kg-width-full {
        padding-left: 4em;
        padding-right: 4em;
    }

    .kg-header-card.kg-align-left {
        text-align: left;
        align-items: flex-start;
    }

    .kg-header-card.kg-style-dark {
        background: #15171a;
        color: #ffffff;
    }

    .kg-header-card.kg-style-light {
        color: #15171a;
        border: 1px solid rgba(124, 139, 154, 0.25);
        border-width: 1px 0;
    }

    .kg-header-card.kg-style-accent {
        background-color: var(--ghost-accent-color);
    }

    .kg-header-card.kg-style-image {
        background-color: #e7e7eb;
        background-size: cover;
        background-position: center center;
    }

    .kg-header-card h2 {
        font-size: 4em;
        font-weight: 700;
        line-height: 1.1em;
        margin: 0;
    }

    .kg-header-card h2 strong {
        font-weight: 800;
    }

    .kg-header-card.kg-size-small h2 {
        font-size: 3em;
    }

    .kg-header-card.kg-size-large h2 {
        font-size: 5em;
    }

    .kg-header-card h3 {
        font-size: 1.25em;
        font-weight: 500;
        line-height: 1.3em;
        margin: 0;
    }

    .kg-header-card h3 strong {
        font-weight: 600;
    }

    .kg-header-card.kg-size-small h3 {
        font-size: 1em;
    }

    .kg-header-card.kg-size-large h3 {
        font-size: 1.5em;
    }

    .kg-header-card:not(.kg-style-light) h2,
    .kg-header-card:not(.kg-style-light) h3 {
        color: #ffffff;
    }

    .kg-header-card a.kg-header-card-button {
        display: flex;
        position: static;
        align-items: center;
        padding: 0 1.2em;
        height: 2.4em;
        line-height: 1em;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
        font-size: 0.95em;
        font-weight: 600;
        text-decoration: none;
        border-radius: 5px;
        transition: opacity 0.2s ease-in-out;
        background-color: var(--ghost-accent-color);
        color: #ffffff;
        margin: 1.75em 0 0;
    }

    .kg-header-card a.kg-header-card-button:hover {
        opacity: 0.85;
    }

    .kg-header-card.kg-size-large a.kg-header-card-button {
        margin-top: 2em;
    }

    .kg-header-card.kg-size-small a.kg-header-card-button {
        margin-top: 1.5em;
    }

    .kg-header-card.kg-style-image a.kg-header-card-button,
    .kg-header-card.kg-style-dark a.kg-header-card-button {
        background: #ffffff;
        color: #15171a;
    }

    .kg-header-card.kg-style-accent a.kg-header-card-button {
        background: #ffffff;
        color: var(--ghost-accent-color);
    }

    .kg-audio-card {
        display: flex;
        width: 100%;
        box-shadow: inset 0 0 0 1px rgba(124, 139, 154, 0.25);
    }

    .kg-audio-thumbnail {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 80px;
        min-width: 80px;
        height: 80px;
        background: transparent;
        object-fit: cover;
        aspect-ratio: 1/1;
        border-radius: 3px 0 0 3px;
    }

    .kg-audio-thumbnail.placeholder {
        background: var(--ghost-accent-color);
    }

    .kg-audio-thumbnail.placeholder svg {
        width: 24px;
        height: 24px;
        fill: white;
    }

    .kg-audio-player-container {
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        width: 100%;
        --seek-before-width: 0%;
        --volume-before-width: 100%;
        --buffered-width: 0%;
    }

    .kg-audio-title {
        width: 100%;
        padding: 8px 12px 0;
        border: none;
        font-family: inherit;
        font-size: 1.1em;
        font-weight: 700;
        background: transparent;
    }

    .kg-audio-player {
        display: none;
    }

    .kg-width-full.kg-card-hascaption {
        display: grid;
        grid-template-columns: inherit;
    }

    .post-content table {
        border-collapse: collapse;
        width: 100%;
    }

    .post-content th {
        padding: 0.5em 0.8em;
        text-align: left;
        font-size: .75em;
        text-transform: uppercase;
    }

    .post-content td {
        padding: 0.4em 0.7em;
    }

    .post-content tbody tr:nth-child(2n + 1) {
        background-color: rgba(0,0,0,0.1);
        padding: 1px;
    }

    .post-content tbody tr:nth-child(2n + 2) td:last-child {
        box-shadow:
            inset 1px 0 rgba(0,0,0,0.1),
            inset -1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:nth-child(2n + 2) td {
        box-shadow: inset 1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:last-child {
        border-bottom: 1px solid rgba(0,0,0,.1);
    }

    .page-footer {
        padding: 60px 5vmin;
        margin: 60px auto 0;
        text-align: center;
        background-color: #f8f8f8;
    }

    .page-footer h3 {
        margin: 0.5rem 0 0 0;
    }

    .page-footer p {
        max-width: 500px;
        margin: 1rem auto 1.5rem;
        font-size: 1.7rem;
        line-height: 1.5em;
        color: rgba(0,0,0,0.6)
    }

    .powered {
        display: inline-flex;
        align-items: center;
        margin: 30px 0 0;
        padding: 6px 9px 6px 6px;
        border: rgba(0,0,0,0.1) 1px solid;
        font-size: 12px;
        line-height: 12px;
        letter-spacing: -0.2px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
        font-weight: 500;
        color: #222;
        text-decoration: none;
        background: #fff;
        border-radius: 6px;
    }

    .powered svg {
        height: 16px;
        width: 16px;
        margin: 0 6px 0 0;
    }

    @media (max-width: 600px) {
        body {
            font-size: 1.6rem;
        }
        h1 {
            font-size: 3rem;
        }

        h2 {
            font-size: 2.2rem;
        }
    }

    @media (max-width: 400px) {
        h1 {
            font-size: 2.6rem;
            line-height: 1.15em;
        }
        h2 {
            font-size: 2rem;
            line-height: 1.2em;
        }
        h3 {
            font-size: 1.7rem;
        }
    }

    :root {--ghost-accent-color: #15171A;}
    </style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="page-header">
        <a href="../../index.html">
                <amp-img class="site-icon" src="https://zairesinatra.github.io//content/images/2021/07/ghost-orb.png" width="50" height="50" layout="fixed" alt="zairesinatra"></amp-img>
        </a>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Git</h1>
                <section class="post-meta">
                    Ziyi Xie -
                    <time class="post-date" datetime="2020-07-18">18 Jul 2020</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="https://zairesinatra.github.io//content/images/2021/09/githubbg.jpg" width="600" height="340" layout="responsive" 
                alt="git"
                ></amp-img>
            </figure>
            <section class="post-content">

                <h2 id="quick-start">Quick Start</h2>
<h3 id="first-time-git">First-Time Git</h3>
<p>集中化版本控制要求所有的代码都存储在中央服务器上，需要通过网络连接到中央服务器来进行版本控制。分布式版本控制不依赖于中央服务器，每个本地仓库都具有完整的版本历史记录和代码库。</p>
<p>通过 <code>git config --list --show-origin</code> 可以查看所有的 Git 配置及其所在：</p>
<ul>
<li><code>/etc/gitconfig</code> 包含系统上每位用户及其对应仓库的通用配置</li>
<li><code>~/.gitconfig</code> 或 <code>~/.config/git/config</code> 针对当前用户的配置文件</li>
<li><code>.git/config</code> 是当前使用仓库的项目配置</li>
</ul>
<p>设置用户名与邮件地址是必不可少的，与此同时，如果使用了 <code>--global</code> 选项，那么设置命令在运行一次后，后续的 Git 操作都会使用这些信息。</p>
<pre><code class="language-shell">$ git config --global user.name "&lt;name&gt;"
$ git config --global user.email "&lt;email&gt;"
</code></pre>
<p>检查全局和仓库级别的配置可以使用 <code>git config --list</code>。查看某个特定配置的值，可以使用 <code>git config &lt;key&gt;</code> 命令，其中 <code>&lt;key&gt;</code> 为要查找的配置项的键名。</p>
<pre><code class="language-shell">$ git config user.name
</code></pre>
<p>Git 中的对象主要有三种类型：Blob、Tree 和 Commit：</p>
<ul>
<li>Blob 对象（二进制大对象）：代表文件内容，存储文件的数据，即文件的快照</li>
<li>Tree 对象：代表目录，存储了一组文件或目录的信息，包括文件名、类型、权限等</li>
<li>Commit 对象：代表一个提交，记录了某一时刻工作目录的状态</li>
</ul>
<blockquote>
<p>Git Index may be defined as the staging area between the workspace and the repository. The major use of Git Index is to set up and combine all changes together before you commit them to your local repository.</p>
</blockquote>
<p>在 Git 中 Index 也称为 Staging Area，即暂存区（索引区），用于保存下一次将要提交的修改，实际上就是一个名为 <code>.git/index</code> 的二进制文件。</p>
<p>在使用 <code>git add</code> 命令后，被添加的文件会存储到 Git 对象库的 <code>.git/objects</code> 目录中，并使用索引进行定位。而后续执行 <code>git commit</code> 命令时，提交的是当前索引中的内容，而不是工作区的内容。同时，在执行提交命令后，<code>.git/objects</code> 目录中会新增 commit 类型和 tree 类型的对象。</p>
<p>注意，<code>.git/objects</code> 目录下每个文件夹的名称前两个字符是对象的 SHA-1 值的前两个字符，每个文件夹中存储了以该 SHA-1 值为名称的对象文件。这些对象文件包含了对象的类型、大小和内容等。</p>
<pre><code class="language-shell">$ git branch -D dev # 删除一个名为 dev 的分支
$ Deleted branch dev (was 45de930).
$ git cat-file -t 45de930 # 查询指定哈希值的对象类型
commit
$ git cat-file -p 45de930 # 查看提交对象的详细信息
tree efb888bed3302a0cb8808046c501d9f3e2a881e8
parent 8c9588c5965a18bd89ccc3f7006a03cb0a0a463b
author ...
committer ...
$ git cat-file -p efb888 # 查看树对象的详细信息
100644 blob 5008ddfcf53c02e82d7eee2e57c38e5672ef89f6	.DS_Store
100644 blob 58c9bdf9d017fcd178dc8c073cbfcbb7ff240d6c	README.md
100644 blob 38f8e886e1a6d733aa9bfa7282568f83c133ecd6	dev.txt
$ git cat-file -p 38f8e886 # 查看被误删的文件 dev.txt 的内容
dev # 垃圾对象 —— 原文件的内容
</code></pre>
<p>在上述代码中查看树对象的详细信息时，有使用到树对象哈希值的前六位，也被称为短哈希。因为哈希值是根据内容计算得到的，所以前几位相同的哈希值代表的对象内容也应该是相同的。通常情况下，建议至少使用前六位，以确保准确性。</p>
<p>SHA-1 算法生成的散列值长度为 160 位，也就是 20 个字节，每个字节可以表示成两位十六进制数，所以通常呈现的散列值长度为 40 个字符。</p>
<p>哈希算法是一种将任意长度的数据映射到固定长度输出的算法，输入数据的任何细微变化都会在输出中体现出来，因此常被用于数据完整性验证、密码存储、数据比对等领域。</p>
<p>如果将多个完全相同的文件添加到对象时，只会存在唯一一个文件对象被存储（文件内容唯一性），这也是得益于 SHA-1 摘要算法。</p>
<p>一个 commit 对象会引用一个 tree 对象，而 tree 对象会引用若干个 blob 对象或其他 tree 对象。因此，一个 commit 对象所引用的 tree 对象包含了本次提交的所有文件，而每个 blob 对象则包含了一个文件的具体内容。</p>
<pre><code class="language-shell">.git/
├── COMMIT_EDITMSG
├── HEAD
...
├── objects
│   ├── 1e/
│   │   └── 6a4608f5fe92ea0169fa033eeac1d38049aa63
│   ├── 05/
│   │   └── 2c88abb60a55ab8be2bca4b5c4cf29271c2de2
...
</code></pre>
<pre><code class="language-shell">$ git cat-file -t 1e6a4608f
commit
</code></pre>
<pre><code class="language-shell">$ git cat-file -p 052c88ab
100644 blob 9cf106272ac3b56b0c4c80218e8fc10a664ca5f4	LICENSE.md
100644 blob ce72ebbfe645054cd7020b980292b37abae34203	README.md
040000 tree 3a654b3398171dc10a94cc1ab0b73ea195307f2f	doc
...
</code></pre>
<blockquote>
<p>HEAD is the reference to the most recent commit in the current branch. This means HEAD is just like a pointer that keeps track of the latest commit in your current branch. Detached HEAD occurs when you check out a commit that is not a branch.</p>
</blockquote>
<p><code>.git/HEAD</code> 存储了当前分支的指针，而 <code>.git/refs/heads/</code> 目录下存储了所有本地分支的指针，分支指针所指向的是相应分支最新提交的 SHA-1 值。在切换分支时，HEAD 会指向不同的分支或提交。</p>
<pre><code class="language-shell">cat refs/heads/master # 最新的 commit 分支
8c9588c5965a18bd89ccc3f7006a03cb0a0a463b
cat HEAD
ref: refs/heads/master
</code></pre>
<p>如果 HEAD 不再指向某个分支而是指向了某个提交，就会进入 "detached HEAD" 状态。此时，如果执行 <code>git log</code> 命令，将只会看到该 commit 前的历史记录。</p>
<h3 id="undoing-things">Undoing Things</h3>
<p>如果在提交后发现有文件遗漏，或是提交信息弄错，可以使用 <code>git commit --amend</code> 来重新提交。</p>
<pre><code class="language-shell">$ git commit -m 'initial commit'
$ git add forgotten_file
$ git commit --amend # 将新的修改合并到上一次提交中，并保留上一次提交的信息
$ git commit --amend -m "&lt;new msg&gt;" # 会将上一次提交的 commit message 替换
</code></pre>
<p>在 Git 中，restore 和 reset 都是用于撤销修改的命令。前者主要用于恢复工作区中的文件，但并不会影响 Git 历史记录。后者则可以将当前 HEAD 重置为指定状态，从而修改 Git 历史记录。</p>
<p><code>git restore --staged &lt;file&gt;</code> 可以用来撤销 <code>git add &lt;file&gt;</code> 命令所做的暂存操作，将文件状态从暂存区恢复到工作区。而 <code>git restore &lt;file&gt;</code> 则可以用来撤销工作区中对文件的修改，将文件状态恢复到最近一次提交时的状态。注意，<code>git restore &lt;file&gt;</code> 只能用来还原文件的内容，而不能还原文件的添加或删除操作。如果要撤销文件的添加或删除操作，需要使用其他命令，如 <code>git rm</code> 或 <code>git add</code>。</p>
<pre><code class="language-shell"># 修改 README 文件
nvim README.md
# 在修改 README 文件后放弃工作目录中的更改
git restore README.md # "git restore &lt;file&gt;..." to discard changes in working directory
</code></pre>
<pre><code class="language-shell"># 修改 README.md 后，将工作区的更改添加到暂存区
git add README.md
# 移除已添加到暂存区的文件，但改动内容不会消失
git restore README.md --staged # "git restore --staged &lt;file&gt;..." to unstage
</code></pre>
<p><code>git reset --soft</code> 会将指定提交后的所有更改放回到暂存区，并将之前暂存区内的更改移动到工作区，工作区的内容不会修改（可能需要手动解决冲突）。</p>
<p><code>git reset</code> 默认的模式是 <code>--mixed</code>，等价 <code>git reset --mixed</code>。<code>git reset --mixed</code> 将指定提交后的所有更改放回到工作区，并将之前添加到暂存区的更改移除暂存区。</p>
<p><code>git reset --hard</code> 将指定提交后的所有更改全部删除（工作区和暂存区）。</p>
<p>注意，如果在执行上述 <code>git reset</code> 命令时未指定提交标识符，则会将当前分支指向上一次的提交。</p>
<p><amp-img src="https://res.cloudinary.com/dzb9ldnvl/image/upload/v1680167282/Ghost/Git/GitTreeMovementsVisualized_v1v2nm.jpg" alt="GitTreeMovementsVisualized_v1v2nm" width="638" height="359" layout="responsive"></amp-img></p>
<pre><code class="language-shell">git commit -m "ctx"
# 撤消提交或暂存快照,即执行 commit 后,还没执行 push 时想要撤销这次的 commit
git reset --soft HEAD^ # 成功撤销 commit; HEAD^ 表示上一个版本,即上一次的 commit,也可以写成 HEAD~1; 如果进行两次的commit，想要都撤回，可以使用HEAD~2
git reset --hard HEAD^ # 连着 add 也撤销 —— 删除工作空间的改动代码(在 README.md 中的改动完全消失)
git reset --mixed HEAD^ # 当前分支的指针会移动到上一次的提交，将之前已经添加到暂存区中的修改移除暂存区，但是这些修改并没有被删除，而是留在了工作区中等待重新提交
</code></pre>
<p>建议在删除分支时使用 <code>--delete</code>，而非 <code>-D</code> 强制删除。删除分支只会删除该分支指向的特定提交记录的指针，并不会删除这些提交记录本身。如果需要恢复已删除的分支，可以通过切换到该分支指向的提交记录来实现。在误删分支的情况下，通常需要 <code>git reflog</code> 来查找被删除的分支的历史记录。</p>
<p>直接键入 <code>git diff</code> 的情况较少，通常都会使用编辑器或者相关工具。Visual Studio Code 中查看 Git 的 diff 可以通过 Source Control 面板来实现。</p>
<ul>
<li><code>git diff</code> 比较工作区和暂存区之间的差异</li>
<li><code>git diff &lt;commit&gt;</code> 比较工作区和某个提交之间的差异</li>
<li><code>git diff &lt;commit1&gt; &lt;commit2&gt;</code> 比较两个提交之间的差异</li>
<li><code>git diff &lt;branch1&gt; &lt;branch2&gt;</code> 比较两个分支之间的差异</li>
<li><code>git diff &lt;commit1&gt; &lt;commit2&gt; &lt;path/to/file&gt;</code> 比较某个文件在两个提交之间的差异</li>
<li><code>git diff &lt;dir1&gt; &lt;dir2&gt;</code> 比较两个目录之间的差异</li>
</ul>
<p>上述 <code>&lt;commit&gt;</code> 表示一个 Git 提交对象的标识符，可以是提交的 SHA-1 值、分支名称、标签名称等。</p>
<h3 id="mysterious-state">Mysterious State</h3>
<blockquote>
<p>After detaching the HEAD by checking out a particular commit, it's allowing us to go to the previous point in the project’s history.</p>
</blockquote>
<p>detached HEAD state 可以让开发者对项目历史中的某个节点进行 Experimental Changes，如果是不小心的误入，可以直接键入 <code>git switch &lt;branch-name&gt;</code> 或 <code>git checkout &lt;branch-name&gt;</code> 离开。</p>
<pre><code class="language-shell">git checkout 8c9588c5
Note: switching to '8c9588c5'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by switching back to a branch.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -c with the switch command. Example:

  git switch -c &lt;new-branch-name&gt;

Or undo this operation with:

  git switch -

Turn off this advice by setting config variable advice.detachedHead to false

HEAD is now at 8c9588c ctx
</code></pre>
<blockquote>
<p>If we want to keep changes made with a detached HEAD, we just create a new branch and switch to it. We can create it right after arriving at a detached HEAD or after creating one or more commits.</p>
</blockquote>
<p>如果在 detached HEAD state 有进行实验性的修改，且有保留这些操作的需求时，可以通过新分支来实现，即使用 <code>git switch -c &lt;new_branch_name&gt;</code> 或 <code>git checkout -b &lt;new_branch_name&gt;</code>。</p>
<p>使用上述命令的原因是 detached HEAD state 指向的是某个特定的提交，而不是任何分支。因此，为了保存这些更改，需要创建一个新的分支来指向这些提交，将这些更改保存下来。</p>
<h3 id="remote-repo">Remote Repo</h3>
<p>连接后，<code>.git/config</code> 中会出现额外的配置，如 <code>[remote "origin"]</code> 与 <code>[branch "main"]</code>。在 refs 以及 logs 中会增加 remotes 以及 origin 目录，对应的在 origin 里会出现 master or main 文件。</p>
<p>经 <code>cat .git/refs/remotes/origin/main</code> 和 <code>cat .git/refs/heads/main</code> 可验证两者是相同的 commit 类型对象。即本地的 main 分支与远程的 main 分支为同步的。若在修改文件后再执行 commit 操作，则 main 分支会领先 origin 分支一次提交，此时通过 <code>push</code> 进行同步。</p>
<pre><code class="language-shell">$ cat .git/refs/remotes/origin/main
8c9588c5965a18bd89ccc3f7006a03cb0a0a463b
$ git cat-file -t 8c9588
commit
$ cat .git/refs/heads/main
8c9588c5965a18bd89ccc3f7006a03cb0a0a463b
</code></pre>
<h3 id="object-compaction-garbage-cleanup">Object Compaction &amp; Garbage Cleanup</h3>
<p>在 Git 中，文件内容存储在 blob 对象，而 Git 对象压缩主要指 blob 对象的压缩。在执行 <code>git add</code> 操作后，Git 会将新增的文件保存为 blob 对象并将其压缩，从而使得 <code>.git/objects</code> 目录中对应的文件体积缩小。</p>
<p>但每一次通过 commit 修改内容后，Git 仍然会累积存储整个对象的压缩版本，因为每个 commit 都是一个新的对象，无法复用之前的 blob 对象。为了优化存储，Git 通过 <code>git gc</code> 命令对不再被引用的对象进行清理和压缩，从而生成 <code>.pack</code> 和 <code>.idx</code> 两个文件，这些文件包含了压缩后的 Git 对象和索引信息，用于加速 Git 的读取和查询操作。在传输到远程仓库时，Git 会将这些压缩后的对象传输到本地，以提高传输效率。使用 <code>unpack</code> 命令可以将这些 <code>pack</code> 文件解压，但是需要注意不能将其放在 objects 目录下解压，以免与现有的对象发生冲突。</p>
<pre><code class="language-shell"># 人类可读性查看文件夹空间使用
$ du -h
#  清理不必要的文件并优化本地存储库
$ git gc
$ tree .git/objects
.git/objects
├── info
│   ├── commit-graph
│   └── packs
└── pack
    ├── pack-643cfb32d355bf2f34006da363c59b5dfd6af348.idx
    └── pack-643cfb32d355bf2f34006da363c59b5dfd6af348.pack

2 directories, 4 files
$ ls -lh .git/objects/pack
total 44728
-r--r--r--  1 xzy  staff   155K Sep 18 00:18 pack-643cfb32d355bf2f34006da363c59b5dfd6af348.idx
-r--r--r--  1 xzy  staff    22M Sep 18 00:18 pack-643cfb32d355bf2f34006da363c59b5dfd6af348.pack
# 查看 pack 文件到底存储的对象详细信息
git verify-pack -v .git/objects/pack/pack-643cfb32d355bf2f34006da363c59b5dfd6af348.idx
.....
.....
# 解压从 github 下载的压缩文件
mv .git/objects/pack/pack-xxx.pack .git/
git unpack-objects &lt; .git/pack-xxx.pack
du -sh .git/objetcs # ??G
</code></pre>
<p>文件的提交通常会产生三种对象，commit、tree 和 blob。但是多次修改会产生中间状态的 blob 对象残余，这些未被引用的对象就是垃圾对象，可使用 <code>git gc</code> 对其进行清理和压缩，以节省磁盘空间。</p>
<p>使用 <code>git gc</code> 生成 pack 文件夹后，垃圾对象会存留在 <code>.git/objects</code> 目录中，可通过 <code>git prune</code> 修剪残余。</p>
<p>这里存在一个特殊的场景：当一个分支提交了改动，未经过合并就被强制删除，那么就会留下未被引用的文件在 <code>.git/objects</code> 目录。这些垃圾对象只与被删除的分支相关，可以通过一些命令来找回删除的分支。但是，这些垃圾对象使用 <code>git prune</code> 是无法删除的，而且它们会被 <code>git gc</code> 压入 pack 文件中，这会占用更多的磁盘空间。此时可以参考一些解决方案，如使用 <code>git reflog</code> 命令来找回被删除的分支，或使用第三方工具如 BFG Repo-Cleaner 来清理未被引用的对象。<a href="https://stackoverflow.com/questions/3797907/how-to-remove-unused-objects-from-a-git-repository">SOF的解决方案</a>。</p>
<pre><code class="language-shell">git -c gc.reflogExpire=0 -c gc.reflogExpireUnreachable=0 \
  -c gc.rerereresolved=0 -c gc.rerereunresolved=0 \
  -c gc.pruneExpire=now gc "$@"
</code></pre>
<pre><code class="language-shell">...
├── eb
│   └── 5ba8320582830bc125255c614a99f783eee4e4
├── f4
│   └── c3a4fd871786674ad955a1346aff85deb21ece
├── f6
│   └── 2bc87aab0e26dcfad058bac0922df2cc018440
├── f7
│   └── 5048e6ee2f678a883ea01c30e5c9ef7e5e3fcc
├── fd
│   └── acdf72972e722927c6179a4a8dfc0386d1f0de
├── info
│   ├── commit-graph
│   └── packs
└── pack
    ├── pack-349bdde18259ef3a0141e73ecc82de3bd9dc4a25.idx
    └── pack-349bdde18259ef3a0141e73ecc82de3bd9dc4a25.pack

56 directories, 66 files
$ git -c gc.reflogExpire=0 -c gc.reflogExpireUnreachable=0 \
  -c gc.rerereresolved=0 -c gc.rerereunresolved=0 \
  -c gc.pruneExpire=now gc "$@"
Enumerating objects: 4402, done.
Counting objects: 100% (4402/4402), done.
Delta compression using up to 8 threads
Compressing objects: 100% (3260/3260), done.
Writing objects: 100% (4402/4402), done.
Total 4402 (delta 901), reused 4402 (delta 901), pack-reused 0
$ tree .git/objects
.git/objects
├── info
│   ├── commit-graph
│   └── packs
└── pack
    ├── pack-349bdde18259ef3a0141e73ecc82de3bd9dc4a25.idx
    └── pack-349bdde18259ef3a0141e73ecc82de3bd9dc4a25.pack

2 directories, 4 files
</code></pre>
<h3 id="hooks">Hooks</h3>
<p>在 Git Hooks 中，示例 Hook 脚本的文件名一般以 <code>.sample</code> 结尾，这是为了方便用户自定义脚本而提供的示例文件。当需要使用这些示例 Hook 脚本时，应将其复制到对应的 Git Hooks 目录下，并移除文件名中的 <code>.sample</code> 后缀，使其成为可执行的 Hook 脚本。</p>
<p>举个例子，假设需要使用示例的 <code>pre-commit.sample</code> Hook 脚本。可以执行以下命令将其复制到项目的 <code>.git/hooks/</code> 目录下，并移除文件名中的 <code>.sample</code> 后缀。</p>
<pre><code class="language-shell">cp .git/hooks/pre-commit.sample .git/hooks/pre-commit
</code></pre>
<p>注意，应该保证 <code>pre-commit</code> 文件是可执行的，即可执行 <code>chmod +x .git/hooks/pre-commit</code>。</p>
<p><a href="https://www.npmjs.com/package/pre-commit">pre-commit</a>是一个可以帮助 JavaScript 生成提交前测试的开发包。</p>
<h3 id="tagging">Tagging</h3>
<p>标签是用来给某个特定的提交打上标记的一个引用，通常被用来标记某个版本的代码，便于在未来可以快速地找到某个特定的版本。标签分为两种类型：Lightweight Tag 和 Annotated Tag。</p>
<p>轻量标签是一个指向某个提交的引用，本质上就是一个指向某个 commit SHA-1 值的指针，并不包含额外的信息。</p>
<pre><code class="language-shell">git tag &lt;tag_name&gt; &lt;commit_SHA&gt;
</code></pre>
<p>附注标签是一个包含额外信息的标签，除了指向某个提交，还包含了标签的创建者、创建时间、标签说明等信息。</p>
<pre><code class="language-shell">git tag -a &lt;tag_name&gt; -m "&lt;tag_message&gt;" &lt;commit_SHA&gt;
</code></pre>
<h2 id="branch-management">Branch Management</h2>
<h3 id="merge-strategies-in-git">Merge Strategies in Git</h3>
<blockquote>
<p>Fast forward merge can be performed when there is a direct linear path from the source branch to the target branch.</p>
</blockquote>
<p>快进合并通常是指从当前分支到目标分支存在一个直线路径的情况。在这种情况下，若想要将当前分支合并到目标分支，Git 会自动将当前分支的 HEAD 指向目标分支的最新提交。快进合并不会产生额外的提交，也不会更改分支历史记录中的顺序。</p>
<p><amp-img src="https://res.cloudinary.com/dzb9ldnvl/image/upload/v1680194972/Ghost/Git/Excalidraw/fast-forward_z3nlen.png" alt="fast-forward" width="1530" height="513" layout="responsive"></amp-img></p>
<pre><code class="language-shell">$ git checkout master &amp;&amp; git merge &lt;feature&gt;
</code></pre>
<p>默认情况下 Git 的 <code>merge</code> 命令是不加选项的，既可以进行快进合并，也可以进行非快进合并。在使用 <code>--ff</code> 选项进行快进合并时，会直接丢失被合并分支的分支信息。</p>
<p>如果想保留被合并分支的分支信息，可以考虑使用 No-fast-foward <code>--no-ff</code> 选项进行普通合并。<code>--no-ff</code> 不等同于三方合并，而是意味着无论源分支的历史记录是怎样的，Git 都将创建一个新的合并提交，以保留源分支和目标分支之间的区别。这样可以在合并后的提交中记录分支的历史信息。如果当前分支包含着其他分支没有的提交时，<code>git merge</code> 默认会使用 <code>--no-ff</code> 合并选项。</p>
<blockquote>
<p>In Recursive merge, after you branch and make some commits, there're some new original commits on the 'master' or 'main'. When it is time to merge, git recurses over the branch and creates a new merge commit.</p>
</blockquote>
<p>递归合并是 Git 在进行多个分支合并时所采用的默认策略。首先执行两个分支的 3-way merge 操作，然后再将合并后的结果与另外一个分支进行 3-way merge 操作，依此类推，直到合并所有的分支。</p>
<p>Three Way Merge 的实现基于三次不同的提交，即分支的共同祖先、Master / Main 分支与 Feature 分支。在找到这三个版本的最近共同祖先，然后将这三个版本的差异应用于最近共同祖先上，生成一个新的合并结果。这种策略可以避免因简单地将两个分支的代码直接合并而导致的冲突与错误。</p>
<p><amp-img src="https://res.cloudinary.com/dzb9ldnvl/image/upload/v1680283477/Ghost/Git/Excalidraw/3-way-merge_wh5kgv.png" alt="3-way-merge" width="1523" height="754" layout="responsive"></amp-img></p>
<p>如上图所示，共同祖先是 C3，即分支产生前的代码，Master 分支是在该分支上最后一次执行提交操作的 C6，Feature 分支是在该分支上最后一次执行提交的 C5。最后，Git 会创建新提交来合并更改。</p>
<p>注意，Merge Conflict 问题通常会出现在 Three Way Merge 的过程中，此时需要手动解决冲突。</p>
<blockquote>
<p>Rebasing is a process to reapply commits on top of another base trip. It is used to apply a sequence of commits from distinct branches into a final commit.</p>
</blockquote>
<p>在使用 <code>git merge</code> 合并分支时，会产生一个新的合并提交，并将源分支的历史记录保留在一个单独的分支上。合并提交保留了分支的完整历史记录，但是会产生导致分支历史变得复杂。</p>
<p>相比之下，<code>git rebase</code> 会将源分支上的每个提交重新设置到目标分支的最新提交之后，从而形成一条更线性的提交历史。这种合并方式被称为变基。变基可以保持提交历史的线性，并使得分支历史变得更加清晰。</p>
<p>在通过 <code>git merge</code> 或 <code>git rebase</code> 命令进行分支合并时，会对合并时的冲突解决策略进行指定：</p>
<ul>
<li><code>ours</code> 选择当前分支上的更改，而忽略其他分支上的更改</li>
<li><code>theirs</code> 选择其他分支上的更改，而忽略当前分支上的更改</li>
<li><code>xours</code> 发生冲突时选择当前分支上的更改；不冲突时仍然选择其他分支上的更改</li>
<li><code>xtheirs</code> 发生冲突时选择其他分支上的更改，不冲突的情况下仍然选择当前分支上的更改</li>
</ul>
<p>例如，命令 <code>git merge -s ours</code> 会忽略其他分支的更改，直接使用当前分支的内容作为合并结果。</p>
<blockquote>
<p>Octopus Merge strategy resolves cases with more than two heads but refuses to do a complex merge that needs manual resolution. It is primarily meant to be used for bundling topic branch heads together. This is one of the merge strategies that Git can use when pulling or merging more than one branch.</p>
</blockquote>
<p>Octopus Merge 策略用于合并包含两个以上头的情况，但是不会做需要手动解决的复杂合并。主要用于将主题分支头捆绑在一起。这是 Git 在拉取或合并多个分支时可以使用的合并策略之一。</p>
<pre><code class="language-shell">$ git merge -s octopus
</code></pre>
<p>当需要将三个或以上的分支合并到一个分支中时，就可以使用该策略。比如现在有三个分支，每个分支都有不同的修改，并想要将这些修改合并到一个新的分支中。</p>
<pre><code class="language-shell">git checkout -b new_branch
git merge A B C
</code></pre>
<p>上述代码将创建一个新分支 <code>new_branch</code> 并使用 Octopus Merge 策略将 A、B 和 C 分支合并到新分支中。如果存在冲突，Git 会暂停合并，等待手动解决冲突。</p>
<p>使用 <code>git add</code> 和 <code>git commit</code> 提交解决方案后，Git 会自动创建一个新提交包含所有分支的修改。</p>
<blockquote>
<p>Resolve strategy can only resolve two heads (i.e. the current branch and another branch you pulled from) using a 3-way merge algorithm. It tries to carefully detect criss-cross merge ambiguities and is considered generally safe and fast."</p>
</blockquote>
<pre><code class="language-shell">$ git merge -s resolve
</code></pre>
<p>Resolve 策略是 <code>git merge</code> 的默认策略。这种自动合并使用 Three-Way Merge 算法来尝试着将两个分支的更改合并到一起。如果有冲突，则需要手动解决。</p>
<blockquote>
<p>Subtree  is a modified recursive strategy. When merging trees A and B, if B corresponds to a subtree of A, B is first adjusted to match the tree structure of A, instead of reading the trees at the same level. This adjustment is also done to the common ancestor tree.</p>
</blockquote>
<p>当想要将一个子项目的仓库合并到父项目的仓库中时，可以使用 Subtree Merge 策略。</p>
<p>例如，有两个仓库，一个是父项目，一个是子项目。子项目中包含着一些可以被父项目重用的代码或文件。如果想要将子项目的内容合并到父项目，那么可以使用 Subtree Merge 策略。</p>
<p>进入父项目的目录后执行以下命令，父项目的仓库中会包含一个指向子项目仓库的子模块，并且该子模块会在父项目的仓库中被记录下来，以便其他人在克隆父项目的仓库时也能同时克隆子项目的仓库。</p>
<pre><code class="language-shell">git submodule add &lt;子项目仓库的 URL&gt; &lt;子模块的存放路径&gt;
git add .
git commit -m "Add child submodule"
</code></pre>
<p>那么在执行以下命令后，可以将子项目的一个特定分支合并到父项目的当前分支中，并将子项目的历史记录合并成一个新的提交。这个新的提交包含了子项目的全部内容，但是不保留子项目的历史记录。最终，父项目的仓库中将包含子项目的内容，并且可以像使用普通的父项目的代码一样使用它们。</p>
<pre><code class="language-shell">git merge -s subtree --squash &lt;branch&gt;
</code></pre>
<h3 id="fetch-pull">Fetch &amp; Pull</h3>
<blockquote>
<p>The git pull command fetches and downloads content from the remote repo and integrates changes into the local repository.</p>
</blockquote>
<blockquote>
<p>The git fetch is a primary command used to download contents from a remote repository.</p>
</blockquote>
<p><code>git pull</code> 等价于执行 <code>git fetch</code> 后立即键入 <code>git merge</code> 将远程分支的更新合并到当前分支。这个操作会自动合并远程分支的更新，但是如果合并有冲突，需要手动解决冲突。</p>
<p><code>git fetch</code> 命令用于从远程仓库下载最新的提交、分支等，并将其保存在本地仓库中，但并不会自动与当前工作分支进行合并。</p>
<p><code>.git/FETCH_HEAD</code> 记录了在最近一次运行 <code>git fetch</code> 时，Git 从远程仓库获取到的所有分支的最新提交对象。在 <code>.git/FETCH_HEAD</code> 中，每个分支都有对应的一条记录。其中，第一条记录往往是 <code>git fetch</code> 时指定远程仓库的某个分支的最新 commit 对象。</p>
<p>如果切换分支后没有重新运行 <code>git fetch</code> 命令，那么 <code>.git/FETCH_HEAD</code> 中的记录不会发生变化。</p>
<p>当远程仓库中的分支发生了改变，却没有再重新运行 <code>git fetch</code>，那么 <code>.git/FETCH_HEAD</code> 中的记录有可能已经过期。</p>
<h3 id="push-tip">Push Tip</h3>
<p>若本地仓库的分支已经与远程仓库中的分支建立了关联，那么在推送时可以直接使用 <code>git push</code>。</p>
<p>若本地仓库中有新的分支，且这些分支还没有和远程仓库中的分支建立关联，直接使用 <code>git push</code> 命令会导致错误。此时需要使用 <code>git push --set-upstream</code> 命令并指定要关联的远程分支，这样本地分支就会与指定的远程分支建立起关联，且以后在推送时就可以直接使用 <code>git push</code>。</p>
<h3 id="cherry-pick">Cherry Pick</h3>
<blockquote>
<p>The cherry-pick command enables arbitrary Git commits to be picked by reference and appended to the current working HEAD.</p>
</blockquote>
<p>挑选提交会尝试将指定提交应用在当前所处的分支，并生成一条新的提交，包含原提交的修改内容。若该过程中出现冲突，需要手动解决冲突并键入 <code>git cherry-pick --continue</code> 以继续应用提交。如果需要取消操作，可以运行 <code>git cherry-pick --abort</code> 命令。</p>
<p>注意，挑选提交会生成一条新的提交，并且会在提交历史中保留原提交的作者、提交时间等信息，但是不会保留原提交的哈希值。这意味着，通过 <code>git cherry-pick</code> 复制的提交，其历史记录与原提交不同，但其包含的修改内容是相同的。</p>
<p>简单来说，假设在分支 A 上开发了某个功能，然后在分支 B 上也需要用到这个功能，那么可以使用 <code>git cherry-pick</code> 命令将 A 分支上的这个提交应用到 B 分支上。在解决可能出现的冲突后，会创建一个新的提交，这个提交会包含 A 分支上的提交所做的更改，同时也会保留 B 分支的作者和提交信息。这样就可以在 B 分支上复用 A 分支上的功能，同时保留 B 分支的提交历史和作者信息。</p>
<pre><code class="language-shell">git cherry-pick &lt;commit-hash&gt;
git cherry-pick &lt;commit-hash-1&gt; &lt;commit-hash-2&gt; ...
</code></pre>
<h2 id="bugs-fix">Bugs Fix</h2>
<ol>
<li>Unable to create './.../.git/index.lock': File exists.</li>
</ol>
<pre><code class="language-shell">fatal: Unable to create './.../.git/index.lock': File exists.
Another git process seems to be running in this repository, e.g.
an editor opened by 'git commit'. Please make sure all processes
are terminated then try again. If it still fails, a git process
may have crashed in this repository earlier:
remove the file manually to continue.
</code></pre>
<p>此类问题一般发生在 git 同时执行两个命令时；也许一个来自命令提示符，一个来自 IDE。通过删除 .git文件中的 index.lock 解决。<a href="https://stackoverflow.com/questions/38004148/another-git-process-seems-to-be-running-in-this-repository">SOF</a></p>
<pre><code class="language-shell">rm -f .git/index.lock
</code></pre>
<ol start="2">
<li>refs/remotes/origin 没有 ref to master？ <a href="https://stackoverflow.com/questions/22855567/why-does-my-refs-remotes-origin-not-have-a-ref-to-master">SOF</a></li>
</ol>
<p>并非所有引用都必须在文件中。引用可以并且已经 "打包"。目前打包的引用可以在纯文本文件 .git/packed-refs 中找到。Git 将 refs/remotes/origin/master 在 .git/packed-refs. 上。</p>
<ol start="3">
<li>fatal: refusing to merge unrelated histories</li>
</ol>
<p>由于两个分支没有取得关联，在需要合并操作后加上 --allow-unrelated-histories。</p>
<pre><code class="language-shell">git merge master --allow-unrelated-histories
git pull origin master --allow-unrelated-histories
</code></pre>
<ol start="4">
<li>fatal: Authentication failed for '<a href="https://github.com/">https://github.com/</a>...'</li>
</ol>
<p>使用 <code>git push --force</code> 时出现授权失败的问题。原因是从 2021-08-14 之后，使用 git 对 github 进行身份验证操作不再接受使用账号密码形式 clone 和 push 代码，而是需要 acces_token 进行验证。在更新 acces_token 后由于提交验证的重置，使用 <code>git push</code> 的方式进行提交验证身份。</p>
<figure class="kg-card kg-bookmark-card kg-card-hascaption"><a class="kg-bookmark-container" href="https://git-scm.com/book/zh/v2"><div class="kg-bookmark-content"><div class="kg-bookmark-title">Git - Book</div><div class="kg-bookmark-description"></div><div class="kg-bookmark-metadata"><amp-img class="kg-bookmark-icon" src="https://git-scm.com/favicon.ico" alt width="32" height="32" layout="fixed"></amp-img><span class="kg-bookmark-author">Book</span></div></div><div class="kg-bookmark-thumbnail"><amp-img src="https://git-scm.com/images/progit2.png" alt width="500" height="660" layout="responsive"></amp-img></div></a><figcaption>Git Book</figcaption></figure><figure class="kg-card kg-bookmark-card kg-card-hascaption"><a class="kg-bookmark-container" href="https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1"><div class="kg-bookmark-content"><div class="kg-bookmark-title">🌳🚀 CS Visualized: Useful Git Commands</div><div class="kg-bookmark-description">Although Git is a very powerful tool, I think most people would agree when I say it can also be... a...</div><div class="kg-bookmark-metadata"><amp-img class="kg-bookmark-icon" src="https://res.cloudinary.com/practicaldev/image/fetch/s--t7tVouP9--/c_limit,f_png,fl_progressive,q_80,w_192/https://practicaldev-herokuapp-com.freetls.fastly.net/assets/devlogo-pwa-512.png" alt width="192" height="192" layout="fixed"></amp-img><span class="kg-bookmark-author">DEV Community</span><span class="kg-bookmark-publisher">Lydia Hallie</span></div></div><div class="kg-bookmark-thumbnail"><amp-img src="https://res.cloudinary.com/practicaldev/image/fetch/s--BkR3VoXZ--/c_imagga_scale,f_auto,fl_progressive,h_500,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/i/rixan4h4z8y94eq89som.png" alt width="1000" height="500" layout="responsive"></amp-img></div></a><figcaption><a href="https://dev.to/lydiahallie">Lydia Hallie</a></figcaption></figure><h2 id="%E7%BB%93%E6%9D%9F">结束</h2>
<p>本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh"> CC BY-SA 4.0 </a>协议，转载请注明出处！</p>


            </section>

        </article>
    </main>
    <footer class="page-footer">
            <amp-img class="site-icon" src="https://zairesinatra.github.io//content/images/2021/07/ghost-orb.png" width="50" height="50" layout="fixed" alt="zairesinatra"></amp-img>
        <h3>zairesinatra</h3>
            <p>The best time to recognize yourself is ten years ago, followed by now.</p>
        <p><a href="../../index.html">Read more posts →</a></p>
        <a class="powered" href="https://ghost.org" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 156 156"><g fill="none" fill-rule="evenodd"><rect fill="#15212B" width="156" height="156" rx="27"/><g transform="translate(36 36)" fill="#F6F8FA"><path d="M0 71.007A4.004 4.004 0 014 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0130 84H4a4 4 0 01-4-4.007v-8.986zM50 71.007A4.004 4.004 0 0154 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0180 84H54a4 4 0 01-4-4.007v-8.986z"/><rect y="34" width="84" height="17" rx="4"/><path d="M0 4.007A4.007 4.007 0 014.007 0h41.986A4.003 4.003 0 0150 4.007v8.986A4.007 4.007 0 0145.993 17H4.007A4.003 4.003 0 010 12.993V4.007z"/><rect x="67" width="17" height="17" rx="4"/></g></g></svg> Published with Ghost</a>
    </footer>
    
</body>
</html>
