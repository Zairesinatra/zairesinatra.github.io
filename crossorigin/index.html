<!DOCTYPE html>
<html lang="en">
<head>

    <title>非同源策略请求——跨域</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css%3Fv=ab47967965.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css%3Fv=ab47967965.css" />
    <meta name="description" content="JSONP—CORS—Proxy" />
    <link rel="icon" href="../content/images/size/w256h256/2021/07/ghost-orb.png" type="image/png" />
    <link rel="canonical" href="index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="amp/index.html" />
    
    <meta property="og:site_name" content="zairesinatra" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="非同源策略请求——跨域" />
    <meta property="og:description" content="JSONP—CORS—Proxy" />
    <meta property="og:url" content="yourdomain.com/crossorigin/" />
    <meta property="og:image" content="yourdomain.com/content/images/2021/08/familyguy-3.jpg" />
    <meta property="article:published_time" content="2021-02-14T13:47:00.000Z" />
    <meta property="article:modified_time" content="2021-10-04T15:29:33.000Z" />
    <meta property="article:tag" content="Technology growth" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="非同源策略请求——跨域" />
    <meta name="twitter:description" content="JSONP—CORS—Proxy" />
    <meta name="twitter:url" content="yourdomain.com/crossorigin/" />
    <meta name="twitter:image" content="yourdomain.com/content/images/2021/08/familyguy-3.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Ziyi Xie" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Technology growth" />
    <meta name="twitter:site" content="@xieziyi0422" />
    <meta property="og:image:width" content="1920" />
    <meta property="og:image:height" content="1080" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "zairesinatra",
        "url": "yourdomain.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "yourdomain.com/content/images/2021/07/zs-1.JPG",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Ziyi Xie",
        "image": {
            "@type": "ImageObject",
            "url": "yourdomain.com/content/images/2021/07/zs-2.JPG",
            "width": 1079,
            "height": 1079
        },
        "url": "yourdomain.com/author/ziyi/",
        "sameAs": []
    },
    "headline": "非同源策略请求——跨域",
    "url": "yourdomain.com/crossorigin/",
    "datePublished": "2021-02-14T13:47:00.000Z",
    "dateModified": "2021-10-04T15:29:33.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "yourdomain.com/content/images/2021/08/familyguy-3.jpg",
        "width": 1920,
        "height": 1080
    },
    "keywords": "Technology growth",
    "description": "JSONP—CORS—Proxy",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "yourdomain.com/"
    }
}
    </script>

    <meta name="generator" content="Ghost 5.2" />
    <link rel="alternate" type="application/rss+xml" title="zairesinatra" href="../rss/index.html" />
    <script defer src="https://unpkg.com/@tryghost/portal@~2.2.0/umd/portal.min.js" data-ghost="yourdomain.com/" data-key="f5d74add11f1d16d3e59c12945" data-api="yourdomain.com/ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="../public/cards.min.js%3Fv=ab47967965"></script>
    <link rel="stylesheet" type="text/css" href="../public/cards.min.css%3Fv=ab47967965.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Q4HQV7NBSG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'G-Q4HQV7NBSG');
</script>

<!-- 2022 prismjs update -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/themes/prism-tomorrow.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet">

<script>
window.addEventListener('DOMContentLoaded', (event) => {      
    document.querySelectorAll('pre[class*=language-]').forEach(function(node) {
        node.classList.add('line-numbers');
	});
    Prism.highlightAll();
});
</script>

<!-- prism -->
<style>
pre[class*="language-"] {
    margin: 0 0 1.5em !important;
}
pre[class*="line-numbers"]>code {
    padding: 0 ;
}
code {
    text-shadow: none !important;
}
.token.operator {
    background: none !important;
}

:not(pre)>code[class*="language-"],
pre[class*="language-"] {
    background: #202124 !important;
}
</style>

<!-- customer theme by zs -->
<style>
/* Generated with http://k88hudson.github.io/syntax-highlighting-theme-generator/www */
/* http://k88hudson.github.io/react-markdocs */
/**
 * @author k88hudson
 *
 * Based on prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */
/*********************************************************
* General
*/
pre[class*="language-"],
code[class*="language-"] {
  color: #d98e73;
  font-size: 13px;
  text-shadow: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  direction: ltr;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  line-height: 1.5;
  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;
  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}
pre[class*="language-"]::selection,
code[class*="language-"]::selection,
pre[class*="language-"]::mozselection,
code[class*="language-"]::mozselection {
  text-shadow: none;
  background: #b3d4fc;
}
@media print {
  pre[class*="language-"],
  code[class*="language-"] {
    text-shadow: none;
  }
}
pre[class*="language-"] {
  padding: 1em;
  margin: .5em 0;
  overflow: auto;
  background: #1e1e1f;
}
:not(pre) > code[class*="language-"] {
  padding: .1em .3em;
  border-radius: .3em;
  color: #db4c69;
  background: #f9f2f4;
}
/*********************************************************
* Tokens
*/
.namespace {
  opacity: .7;
}
.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
  color: #93a1a1;
}
.token.punctuation {
  color: #f3f3f3;
}
.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
  color: #88deff;
}
.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
  color: #ddb974;
}
.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  color: #f3f3f3;
  background: #1e1e1f;
}
.token.atrule,
.token.attr-value,
.token.keyword {
  color: #06b4fe;
}
.token.function {
  color: #80caf1;
}
.token.regex,
.token.important,
.token.variable {
  color: #ee9900;
}
.token.important,
.token.bold {
  font-weight: bold;
}
.token.italic {
  font-style: italic;
}
.token.entity {
  cursor: help;
}
/*********************************************************
* Line highlighting
*/
pre[data-line] {
  position: relative;
}
pre[class*="language-"] > code[class*="language-"] {
  position: relative;
  z-index: 1;
}
.line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: #1e1e1f;
  box-shadow: inset 5px 0 0 #1e1e1f;
  z-index: 0;
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}
</style>

<!-- 音乐播放器 -->
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><style>:root {--ghost-accent-color: #15171A;}</style>

</head>
<body class="post-template tag-technology-growth has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <nav class="gh-head-inner inner">

            <div class="gh-head-brand">
                <a class="gh-head-logo" href="../index.html">
                        <img src="../content/images/2021/07/zs-1.JPG" alt="zairesinatra" />
                </a>
                <a class="gh-burger" role="button">
                    <div class="gh-burger-box">
                        <div class="gh-burger-inner"></div>
                    </div>
                </a>
            </div>
            <div class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="../index.html">Home</a></li>
    <li class="nav-welcome"><a href="../welcome/index.html">Welcome</a></li>
    <li class="nav-author"><a href="../selfintro/index.html">Author</a></li>
    <li class="nav-tag"><a href="../tag/index.html">Tag</a></li>
    <li class="nav-links"><a href="http://nav.zairesinatra.com/">Links</a></li>
</ul>

            </div>
            <div class="gh-head-actions">
                <div class="gh-social">
                        <a class="gh-social-link gh-social-twitter" href="https://twitter.com/xieziyi0422" title="Twitter" target="_blank" rel="noopener"><svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg></a>
                </div>
                        <a class="gh-head-button" href="index.html#/portal/signup" data-portal="signup">Subscribe</a>
            </div>
        </nav>
    </header>

    <div class="site-content">
        



<main id="site-main" class="site-main">
<article class="article post tag-technology-growth featured ">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
                <span class="post-card-primary-tag">
                    <a href="../tag/technology-growth/index.html">Technology growth</a>
                </span>
                <span class="post-card-featured"><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M4.49365 4.58752C3.53115 6.03752 2.74365 7.70002 2.74365 9.25002C2.74365 10.6424 3.29678 11.9778 4.28134 12.9623C5.26591 13.9469 6.60127 14.5 7.99365 14.5C9.38604 14.5 10.7214 13.9469 11.706 12.9623C12.6905 11.9778 13.2437 10.6424 13.2437 9.25002C13.2437 6.00002 10.9937 3.50002 9.16865 1.68127L6.99365 6.25002L4.49365 4.58752Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
</svg> Featured</span>
        </div>

        <h1 class="article-title">非同源策略请求——跨域</h1>

            <p class="article-excerpt">JSONP—CORS—Proxy</p>

        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../author/ziyi/index.html" class="author-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2021/07/zs-2.JPG" alt="Ziyi Xie" />
                    </a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="../author/ziyi/index.html">Ziyi Xie</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2021-02-14">Feb 14, 2021</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 6 min read</span>
                </div>
            </div>

        </section>
        </div>

            <figure class="article-image">
                <img
                    srcset="../content/images/size/w2000/2021/08/familyguy-3.jpg 2000w"
                    sizes="(min-width: 1400px) 1400px, 92vw"
                    src="../content/images/size/w2000/2021/08/familyguy-3.jpg"
                    alt="非同源策略请求——跨域"
                />
                    <figcaption>Familyguy</figcaption>
            </figure>

    </header>

    <section class="gh-content gh-canvas">
        <aside class="toc-container">
            <div class="toc"></div>
        </aside>
        <!--kg-card-begin: markdown--><h2 id="%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5">同源策略</h2>
<blockquote>
<p>浏览器安全的基石是 &quot;同源政策&quot;（same-origin policy）。 Netscape 公司引入浏览器。目前，所有浏览器都实行这个政策。</p>
<p>所谓同源是指 &quot;协议+域名+端口&quot; 三者相同，即便两个不同的域名指向同一个 IP 地址，也非同源。<br>
它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，浏览器很容易受到 XSS、CSFR 等攻击。</p>
<p>同源策略限制以下几种行为：</p>
<p>（1） Cookie、LocalStorage 和 IndexDB 无法读取。（2） DOM 无法获得。（3） AJAX 请求不能发送。</p>
</blockquote>
<p>这里主要强调一下，在域名和域名对应相同 IP 的情况下，由于同源策略，也是不允许通讯的。而在服务器端（项目上线部署完成）则不存在跨域问题，跨域是针对浏览器的协议、域名、端口而言的。</p>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="jsonp">JSONP</h2>
<p>浏览器同源策略导致网页中无法通过 Ajax 请求非同源的接口数据， JSONP 的原理是部分 HTML 标签不存在跨域请求的限制，如 script、iframe、img、link。</p>
<p>在 React 开发中，组件通讯的属性传递一般只能父传子，要是想实现子传父，可以通过父组件提供一个回调函数接收数据，将该函数作为属性的值，传递给子组件，子组件通过 props 调用回调函数。这里使用的就是类似 JSONP 原理。同样的还有在 Hybrid APP 混合开发中，考虑到现在 ios 通讯不仅仅是 JSBridge ，还有伪 url 协议。通过 location.href 与执行 callback 方法，原生 ios APP 会在拦截请求后解析协议执行。</p>
<p>局限同样存在，因为<strong>所有的 src 都是资源文件请求</strong>，导致 JSONP 只能使用 get 方法，且未使用 XHR 对象；在 url 问号传参将函数传递给服务器时，会存在 url 劫持的问题。</p>
<pre><code class="language-javascript">// nodeJS
const express = require('express');
const app = express();
const port = 3000;
app.get('/JSONP', (req,res)=&gt;{
    let { callback } = req.query;
    let data = {
        code: 1129,
        message: 'zsxzy finished the request!'
    }
    res.send(`${callback}(${JSON.stringify(data)})`)
});
app.listen(port, () =&gt; {
    console.log(`app listen is running at http://localhost:${port}`);
});
</code></pre>
<pre><code class="language-html">&lt;script src=&quot;./JSONPtest.js&quot;&gt;&lt;/script&gt;
</code></pre>
<pre><code class="language-javascript">// JSONPtest.js
$.get({
    url: 'http://localhost:3000/JSONP', // 切忌写成 https 会出现 net::ERR_SSL_PROTOCOL_ERROR 错误
    method: 'get',
    // 如果要指定 $.ajax 发起 jsonp 请求则必须指定 dataType 为 jsonp
    dataType: 'jsonp',
    success: res =&gt; {
        console.log(res);
    }
})
</code></pre>
<p>默认情况下使用 jQuery 发送 JSONP 请求会自动携带一个 callback=jQueryxxx参数， jQueryxxx 是随机生成的一个回调函数的名称。</p>
<p>jQuery 中的 JSONP 实现过程：动态在 <code>&lt;header&gt;</code> 中创建 (append) 和移除 (remove) <code>&lt;script&gt;</code> 标签的方式，发起 JSONP 数据请求。</p>
<!--kg-card-end: markdown--><figure class="kg-card kg-image-card kg-card-hascaption"><img src="../content/images/2021/08/--2021-08-06---4.50.33-1.png" class="kg-image" alt="JSONP" loading="lazy" width="1172" height="142" srcset="../content/images/size/w600/2021/08/--2021-08-06---4.50.33-1.png 600w, ../content/images/size/w1000/2021/08/--2021-08-06---4.50.33-1.png 1000w, ../content/images/2021/08/--2021-08-06---4.50.33-1.png 1172w" sizes="(min-width: 720px) 720px"><figcaption>JSONP</figcaption></figure><!--kg-card-begin: markdown--><h2 id="cors-%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB">CORS 跨域资源共享</h2>
<p>CORS 实质上是一系列决定浏览器是否阻止前端跨域获取资源的 HTTP 响应请求头组。通过配置接口服务器相关 HTTP 响应头可以解除浏览器端跨域访问限制。</p>
<p>客户端在请求 CORS 时，根据请求方式与请求头不同，可以将 CORS 分为两大类：简单请求、预检请求。</p>
<ul>
<li>请求方式是 GET、POST、HEAD 且 HTTP 头部信息不超过上述代码几种字段（无自定义头部字段）则为简单请求。</li>
<li>请求方式为 GET、POST、HEAD 以外的 METHOD 类型、请求头包含自定义头部字段、向服务器发送了 application\json 格式的数据，满足其中任何一种条件都是预检请求。</li>
</ul>
<pre><code class="language-javascript">const express = require('express');
// const cors = require('cors')
const app = express();
const port = 3001;
// 粗暴型
// app.use(cors())
// 使用 express + node 时使用如下配置中间件配置头即可
app.use((req, res, next) =&gt; {
    // Access-Control-Allow-Origin - 允许访问该资源的外域URL
    // 使用 * 避免只有单个源可以访问, 但是就不可以携带 cookie =&gt; 保证安全
    res.header('Access-Control-Allow-Origin', 'http://localhost:3000');
    res.header('Access-Control-Allow-Methods', 'GET, POST, DELETE, OPTIONS, HEAD');
    // 支持客户端向服务器发送如下的 9 个请求头
    res.header('Access-Control-Allow-Headers', 'Accept,Accept-Language,Content-Language,DPR,Downlink,Save-Data,Viewport-Width,Width,Content-Type');
    // 是否允许携带资源凭证-cookie
    res.header('Access-Control-Allow-Credentials', true);
    // 所有 cors 预先发送 OPTIONS 试探性请求 —— 用完注释即可
    // req.method === 'OPTIONS' ? res.send('SURPPORT CROSS DOMAIN REQUEST') : res.send('SORRY zairesinatra, you cant cross, somewhere happens error')
    next();
})
app.get('/getcors',function (req, res) {
    res.send('zsxzy finished the request!')
});
app.listen(port, () =&gt; {
    console.log(`app listen is running at http://localhost:${port}`);
})
</code></pre>
<pre><code class="language-javascript">// $.ajax({
//   method:'OPTIONS',
//   url: 'http://localhost:3001',
//   success: res =&gt; {
//     console.log(res); // SURPPORT CROSS DOMAIN REQUEST
//   }
// })
$.ajax({
  method:'get',
  url: 'http://localhost:3001/getcors',
  success: res =&gt; {
    console.log(res); // zsxzy finished the request!
  }
})
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8">代理服务器</h2>
<p>Vue 项目可以在需要跨域时直接请求本地服务器 8080 端口，通过配置代理转发给远程服务器（资源服务器、数据服务器...）获取资源。值得注意的是，若请求的内容存在同名于 public 目录中的文件名，那么不会转发给服务器，而是直接从 public 目录读取。</p>
<pre><code class="language-javascript">// App.vue
created () {
    axios.get('/devserver').then(res =&gt; console.log(res.data))
    this.testtt()
},
methods: {
    testtt () {
        var xhr = new XMLHttpRequest()
        xhr.open('GET', 'http://localhost:8080/getcors', true)
        xhr.send()
        xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) {
          console.log(xhr.responseText);
        }}
    }
}
</code></pre>
<pre><code class="language-javascript">// vue.config.js
// vue.config.js 打包后就不起作用. 可选项 vue.config.js 文件就等同于 webpack 的 webpack.config.js . vue-cli3 之后并不会自动创建 vue.config.js , 因为都是需要修改 webpack 的时候才会创建 vue.config.js 进行配置.
module.exports = {
    devServer: {
        host: 'localhost',
        // 项目开启端口
        port: 8080,
        proxy: {
            // /getcors 表示拦截以 getcors 开头的地址
            '/getcors': {
                target: 'http://localhost:3001',
                changeOrigin: true // 是否如实禀报服务器 - 后端通过request.get('Host')查看
            },
            '/devserver': {
                target: 'http://localhost:3001',
                changeOrigin: true
            },
            '/needrewrite': {
                target: 'http://localhost:3002',
                changeOrigin: true,
                // 匹配以 needrewrite 开头的路径转为空字符串.
                // 避免携带控制服务器作用的 needrewrite,被携带到请求路径中
                pathRewrite: {'^/needrewrite':''},
                ws: true // 用于支持 websockect
            }
        }
    }
}
</code></pre>
<pre><code class="language-javascript">// node.js 后端服务
const express = require('express');
const app = express();
const port = 3001;

app.get('/getcors',function (req, res) {
    res.send('zsxzy finished the request!')
});
app.get('/devserver',function (req, res) {
    res.send('zsxzy finished the request by devserver!')
});
app.listen(port, () =&gt; {
    console.log(`app listen is running at http://localhost:${port}`);
})
</code></pre>
<pre><code class="language-javascript">// 核心原理: webpack 的 devServer.proxy 使用的 http-proxy-middleware 包
const express = require('express');
const { createProxyMiddleware } = require('http-proxy-middleware')
const app = express();
const port = 8080;
app.use(
    &quot;/&quot;,
    createProxyMiddleware({
      target: &quot;http://localhost:3001&quot;,
      changeOrigin: true
    })
)

app.listen(port, () =&gt; {
    console.log(`app listen is running at http://localhost:${port}`);
})
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="%E7%BB%93%E6%9D%9F">结束</h2>
<p>本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh"> CC BY-SA 4.0 </a>协议 ，转载请注明出处！</p>
<!--kg-card-end: markdown-->
    </section>


    
    <section class="article-comments gh-canvas">
        <div id="disqus_thread"></div>
        <script>
            var disqus_config = function () {
                this.page.url = "yourdomain.com/crossorigin/";
                this.page.identifier = "ghost-610c4d8d9d12cb5936240827"
            };
            (function() {
            var d = document, s = d.createElement('script');
            s.src = 'https://zsxzy.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
            })();
        </script>
    </section>
   

</article>
</main>

    <section class="footer-cta outer">
        <div class="inner">
            <h2 class="footer-cta-title">Sign up for more like this.</h2>
            <a class="footer-cta-button" href="index.html#/portal" data-portal>
                <div class="footer-cta-input">Enter your email</div>
                <span>Subscribe</span>
            </a>
        </div>
    </section>



            <aside class="read-more-wrap outer">
                <div class="read-more inner">
                        
<article class="post-card post">

    <a class="post-card-image-link" href="../g-toc-css/index.html">

        <img class="post-card-image"
            srcset="../content/images/size/w600/2022/04/SLAMDUNK.png 600w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2022/04/SLAMDUNK.png"
            alt="SLAM DUNK"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../g-toc-css/index.html">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    G&amp;TOC&amp;CSS
                </h2>
            </header>
                <div class="post-card-excerpt">TOC 的需求实现以及相关的思考总结。</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2022-05-01">May 1, 2022</time>
                <span class="sep">—</span>
                <span class="post-card-meta-length">6 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="../mybatis/index.html">

        <img class="post-card-image"
            srcset="../content/images/size/w600/2022/07/GreenTreesUnderBlueSky.jpg 600w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2022/07/GreenTreesUnderBlueSky.jpg"
            alt="Green Trees Under Blue Sky"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../mybatis/index.html">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    MyBatis
                </h2>
            </header>
                <div class="post-card-excerpt">半自动 ORM Object Relation Mapping 持久层框架 MyBatis</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2022-02-02">Feb 2, 2022</time>
                <span class="sep">—</span>
                <span class="post-card-meta-length">44 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="../mysqlnote/index.html">

        <img class="post-card-image"
            srcset="../content/images/size/w600/2022/04/cloud.jpg 600w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2022/04/cloud.jpg"
            alt="mysql"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../mysqlnote/index.html">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    MySQL 笔记
                </h2>
            </header>
                <div class="post-card-excerpt">MYSQL 基础篇</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2021-12-22">Dec 22, 2021</time>
                <span class="sep">—</span>
                <span class="post-card-meta-length">82 min read</span>
        </footer>

    </div>

</article>
                </div>
            </aside>



    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="../index.html">zairesinatra</a> &copy; 2022</section>
            <nav class="site-footer-nav">
                
            </nav>
            <div><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>


<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="../assets/built/casper.js%3Fv=ab47967965"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

<!-- 2022 prismjs update -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/autoloader/prism-autoloader.min.js" onload="Prism.plugins.autoloader.languages_path='https://cdn.bootcss.com/prism/1.19.0/components/'"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-javascript.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-powershell.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-sql.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-jsx.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-java.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/toolbar/prism-toolbar.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
<script defer src="https://cdn.bootcss.com/prism/1.19.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>



<!-- music -->
<script src="http://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
<script src="http://cdn.jsdelivr.net/npm/meting@1.2.0/dist/Meting.min.js"></script>
<script>
	var meting_api='http://api.mizore.cn/meting/api.php?server=:server&type=:type&id=:id'
		$('.carousel').carousel({
			interval: 3000
		})
</script>
<!-- music -->
<div class="aplayer" data-id="7260570761" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false" data-volume="0.6" lrc-type="0"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.min.js"></script>
<script>
    tocbot.init({
        tocSelector: '.toc',
        contentSelector: '.gh-content',
        hasInnerContainers: true
    });
    var tc = document.querySelector(".toc-container");
    var tch = tc.clientHeight;
    var ah = document.querySelector(".article-header");
    var ahh = ah.clientHeight;
    window.addEventListener("scroll", function () {
    if(document.body.clientWidth > 1170){
        var scrollY = document.documentElement.scrollTop || document.body.scrollTop;
        var ihh = window.innerHeight;
        if(scrollY >= ihh + tch + ahh){
            var ctc = document.querySelector(".toc-container");
            ctc.style.position="sticky";
            ctc.style.position="-webkit-sticky";
            ctc.style.top = "120px";
            ctc.style.marginLeft = "800px";
            ctc.style.minWidth= "260px";
        }
        if(scrollY < tch + ahh -10){
            var ctc = document.querySelector(".toc-container");
            ctc.style.position="";
            ctc.style.top = "";
            ctc.style.marginLeft = "";
            console.log("zszszs")
        }
    }
    })
</script>
</body>
</html>
