<!DOCTYPE html>
<html lang="en">
<head>

    <title>JavaWeb</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css%3Fv=58ac320af1.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css%3Fv=58ac320af1.css" />
    <meta name="description" content="JavaWeb 开发相关，不包含 JSP、Thymeleaf。" />
    <link rel="icon" href="../content/images/size/w256h256/2021/07/ghost-orb.png" type="image/png" />
    <link rel="canonical" href="index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="amp/index.html" />
    
    <meta property="og:site_name" content="zairesinatra" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="JavaWeb" />
    <meta property="og:description" content="JavaWeb 开发相关，不包含 JSP、Thymeleaf。" />
    <meta property="og:url" content="https://zairesinatra.github.io//javaweb/" />
    <meta property="og:image" content="https://zairesinatra.github.io//content/images/2022/05/dragonBall.jpg" />
    <meta property="article:published_time" content="2019-06-04T13:22:00.000Z" />
    <meta property="article:modified_time" content="2023-01-01T09:41:42.000Z" />
    <meta property="article:tag" content="Technology growth" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="JavaWeb" />
    <meta name="twitter:description" content="JavaWeb 开发相关，不包含 JSP、Thymeleaf。" />
    <meta name="twitter:url" content="https://zairesinatra.github.io//javaweb/" />
    <meta name="twitter:image" content="https://zairesinatra.github.io//content/images/2022/05/dragonBall.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Ziyi Xie" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Technology growth" />
    <meta name="twitter:site" content="@xieziyi0422" />
    <meta property="og:image:width" content="2000" />
    <meta property="og:image:height" content="1125" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "zairesinatra",
        "url": "https://zairesinatra.github.io//",
        "logo": {
            "@type": "ImageObject",
            "url": "https://zairesinatra.github.io//content/images/2021/07/zs-1.JPG",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Ziyi Xie",
        "image": {
            "@type": "ImageObject",
            "url": "https://zairesinatra.github.io//content/images/2021/07/zs-2.JPG",
            "width": 1079,
            "height": 1079
        },
        "url": "https://zairesinatra.github.io//author/ziyi/",
        "sameAs": []
    },
    "headline": "JavaWeb",
    "url": "https://zairesinatra.github.io//javaweb/",
    "datePublished": "2019-06-04T13:22:00.000Z",
    "dateModified": "2023-01-01T09:41:42.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://zairesinatra.github.io//content/images/2022/05/dragonBall.jpg",
        "width": 2000,
        "height": 1125
    },
    "keywords": "Technology growth",
    "description": "JavaWeb 开发相关，不包含 JSP、Thymeleaf。",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://zairesinatra.github.io//"
    }
}
    </script>

    <meta name="generator" content="Ghost 5.33" />
    <link rel="alternate" type="application/rss+xml" title="zairesinatra" href="../rss/index.html" />
    <script defer src="https://cdn.jsdelivr.net/ghost/portal@~2.24/umd/portal.min.js" data-ghost="https://zairesinatra.github.io//" data-key="f5d74add11f1d16d3e59c12945" data-api="https://zairesinatra.github.io//ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="f5d74add11f1d16d3e59c12945" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://zairesinatra.github.io//" crossorigin="anonymous"></script>
    <link href="https://zairesinatra.github.io//webmentions/receive/" rel="webmention" />
    <script defer src="../public/cards.min.js%3Fv=58ac320af1"></script>
    <link rel="stylesheet" type="text/css" href="../public/cards.min.css%3Fv=58ac320af1.css">
    <script defer src="../public/member-attribution.min.js%3Fv=58ac320af1"></script>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NXZH6Q3K52"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NXZH6Q3K52');
</script>
<!-- Ghost Init -->
<style>
.post-template .gh-head,
.page-template .gh-head {
  background: #000000 !important;
}
.site-footer {
  background: #000000 !important;
}
.post-card-tags {
  color: var(--color-secondary-text) !important;
}
.gh-portal-triggerbtn-container.with-label::before {
  display: none !important;
}
/* 需提前，否则闪烁 */
.footer-cta,
a.gh-head-button {
  display: none;
}
.algoliaouterwrapper i svg {
  width: 0;
}
/* 更多内容去除外边距 */
.footer-cta + .read-more-wrap {
  margin-top: unset;
}
</style>

<!-- 2023 => prismjs -->
<script src="https://res.cloudinary.com/dzb9ldnvl/raw/upload/v1679662056/Ghost/prism_i9a8up.js"></script>
<link rel="stylesheet" href="https://res.cloudinary.com/dzb9ldnvl/raw/upload/v1679662068/Ghost/prism_mdfwkg.css"/>
<!-- Patch: additional supported languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-vim.min.js" integrity="sha512-P1MRK1H11qw68MAfAYVyjumLuurOQKO4wwcx4S2Nbbae9CndG92dkIXq34lsOeMFlWZoT7nVPgsOy3gepk93Bg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<!-- Activate Line Numbers in PrismJS -->
<script>
	window.addEventListener('DOMContentLoaded', (event) => {      
		document.querySelectorAll('pre[class*=language-]').forEach(function(node) {
			node.classList.add('line-numbers');
            node.style.border = 'solid #FFFFFF 1px'
		});
		Prism.highlightAll();
	});
</script>
<!-- Resize Pre Area in PrismJS -->
<style>
    pre[class*="language-"].line-numbers{
		font-size: 0.8em;
        background-color: #202324;
    }
    code[class*="language-"] {
        background-color: transparent !important;
    }
</style>
<!-- TOC -->
<style>
    .toc > .toc-list li:first-child {
      margin-top: 8px;
    }
    .toc-list a {
      color: #000000 !important;
      text-decoration: none;
      word-break: break-word;
    }
    .toc > ol, .toc > li{
      font-size: 1.4rem;
    }
    
    .toc.active > .toc-list li:first-child {
      margin-top: 8px;
    }
    .toc.active .toc-list a {
      color: #FFFFFF !important;
      text-decoration: none;
      word-break: break-word;
    }
    .toc.active > ol, .toc.active > li{
      font-size: 1.4rem;
    }
</style>

<!-- ghost style by wkzs -->
<style>
.gh-content > [id] + * {
  margin-top: 2.5rem !important;
}
.gh-content > [id]:not(:first-child) {
  margin: 1.5em 0 0;
}
.gh-content > hr + *, .gh-content > blockquote + * {
  margin-top: max(1.1rem, 16px) !important;
}
.gh-content > [id]:not(:first-child) {
  margin: 1em 0 0;
}
.gh-content > * + * {
  margin-top: max(1.6vmin, 16px);
  margin-bottom: 0;
}
.gh-content > blockquote:not([class]), .gh-content > ol, .gh-content > ul, .gh-content > dl, .gh-content > p {
    font-family: var(--font-serif);
    font-weight: 400;
    font-size: 1.6rem;
    line-height: 1.6em;
    margin-top: 1.6rem;
}
</style>

<!-- Theme Change -->
<style>
@keyframes slideUp {
  from {
    bottom: 100px;
    opacity: 0;
  }
  to {
    bottom: 0;
    opacity: 1;
  }
}
.theme-switcher-wrap {
  width: 42px;
  height: 24px;
  text-align: right;
}
@media (max-width: 767px) {
  .gh-head-open .theme-switcher-wrap {
    width: 42px;
    height: 24px;
    text-align: right;
    animation: slideUp 1s ease-in-out forwards;
  }
}
.theme-switcher {
  display: inline-block;
  cursor: pointer;
}
.switch-path {
  width: 42px;
  height: 24px;
  border-radius: 10px;
  background-color: #f2f2f2;
  border: #dddfe6 1px solid;
}
.switch-path > .switch-handle {
  background-color: #ffffff;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  transition: all 0.3s ease-in-out;
}
.switch-handle .dark-icon {
  visibility: hidden;
  display: none;
}
.theme-switcher.active .switch-path {
  background-color: #555;
}
.theme-switcher.active .switch-handle {
  transform: translateX(20px);
  background-color: #101115;
}
.theme-switcher.active .switch-handle .light-icon {
  visibility: hidden;
}
.theme-switcher.active .switch-handle .dark-icon {
  visibility: visible;
  display: block;
}
</style>

<!-- Drak Theme Ghost CSS -->
<style>
.dark-mode .gh-content > blockquote:not([class])::before {
  background: #FFFFFF !important;
}
</style>

<!-- Arrow up -->
<style>
    .arrowup {
    	position: fixed;
        width: 50px;
        height: 50px;
        left: 35px;
        bottom: 3.1rem;
        z-index: 99;
        background-color: #15171A;
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 10px;
        cursor: pointer;
        opacity: 1;
  		transition: opacity 0.3s ease-in-out;
    }
    .arrowup svg {
    	fill: #FFFFFF;
    }
    .arrowup:hover {
      opacity: 0.8;
    }
</style><style>:root {--ghost-accent-color: #15171A;}</style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/></pre></li>
</head>
<body class="post-template tag-technology-growth is-head-left-logo has-cover">
<div class="viewport">
    <header id="gh-head" class="gh-head outer">
        <div class="gh-head-inner inner">
            <div class="gh-head-brand">
                <a class="gh-head-logo" href="../index.html">
                        <img src="../content/images/2021/07/zs-1.JPG" alt="zairesinatra">
                </a>
                <button class="gh-search gh-icon-btn" onclick="docSearchFuncMobile()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <button class="gh-burger"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="../index.html">Home</a></li>
    <li class="nav-welcome"><a href="../welcome/index.html">Welcome</a></li>
    <li class="nav-author"><a href="../selfintro/index.html">Author</a></li>
    <li class="nav-tags"><a href="../tags/index.html">Tags</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                <div class="theme-switcher-wrap">
                    <div class="theme-switcher" onclick="switchTheme()">
                    <div class="switch-path">
                        <div class="switch-handle">
                        <svg viewBox="0 0 24 24" class="dark-icon">
                            <path
                            d="M11.01 3.05C6.51 3.54 3 7.36 3 12a9 9 0 0 0 9 9c4.63 0 8.45-3.5 8.95-8c.09-.79-.78-1.42-1.54-.95A5.403 5.403 0 0 1 11.1 7.5c0-1.06.31-2.06.84-2.89c.45-.67-.04-1.63-.93-1.56z"
                            fill="#CFD3DC"
                            ></path>
                        </svg>
                        <svg viewBox="0 0 24 24" class="light-icon">
                            <path
                            d="M6.05 4.14l-.39-.39a.993.993 0 0 0-1.4 0l-.01.01a.984.984 0 0 0 0 1.4l.39.39c.39.39 1.01.39 1.4 0l.01-.01a.984.984 0 0 0 0-1.4zM3.01 10.5H1.99c-.55 0-.99.44-.99.99v.01c0 .55.44.99.99.99H3c.56.01 1-.43 1-.98v-.01c0-.56-.44-1-.99-1zm9-9.95H12c-.56 0-1 .44-1 .99v.96c0 .55.44.99.99.99H12c.56.01 1-.43 1-.98v-.97c0-.55-.44-.99-.99-.99zm7.74 3.21c-.39-.39-1.02-.39-1.41-.01l-.39.39a.984.984 0 0 0 0 1.4l.01.01c.39.39 1.02.39 1.4 0l.39-.39a.984.984 0 0 0 0-1.4zm-1.81 15.1l.39.39a.996.996 0 1 0 1.41-1.41l-.39-.39a.993.993 0 0 0-1.4 0c-.4.4-.4 1.02-.01 1.41zM20 11.49v.01c0 .55.44.99.99.99H22c.55 0 .99-.44.99-.99v-.01c0-.55-.44-.99-.99-.99h-1.01c-.55 0-.99.44-.99.99zM12 5.5c-3.31 0-6 2.69-6 6s2.69 6 6 6s6-2.69 6-6s-2.69-6-6-6zm-.01 16.95H12c.55 0 .99-.44.99-.99v-.96c0-.55-.44-.99-.99-.99h-.01c-.55 0-.99.44-.99.99v.96c0 .55.44.99.99.99zm-7.74-3.21c.39.39 1.02.39 1.41 0l.39-.39a.993.993 0 0 0 0-1.4l-.01-.01a.996.996 0 0 0-1.41 0l-.39.39c-.38.4-.38 1.02.01 1.41z"
                            fill="#606266"
                            ></path>
                        </svg>
                        </div>
                    </div>
                    </div>
                </div>
                    <button class="gh-search gh-icon-btn" onclick="docSearchFuncMobile()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                    <div class="gh-head-members">
                                <a class="gh-head-link" href="index.html#/portal/signin" data-portal="signin">Sign in</a>
                                <a class="gh-head-button" href="index.html#/portal/signup" data-portal="signup">Subscribe</a>
                    </div>
            </div>
        </div>
    </header>

    <div class="site-content">
      <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
        



<main id="site-main" class="site-main">
<article class="article post tag-technology-growth ">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
                <span class="post-card-primary-tag">
                    <a href="../tag/technology-growth/index.html">Technology growth</a>
                </span>
        </div>

        <h1 class="article-title">JavaWeb</h1>

            <p class="article-excerpt">JavaWeb 开发相关，不包含 JSP、Thymeleaf。</p>

        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../author/ziyi/index.html" class="author-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2021/07/zs-2.JPG" alt="Ziyi Xie" />
                    </a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="../author/ziyi/index.html">Ziyi Xie</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2019-06-04">Jun 4, 2019</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 25 min read</span>
                </div>
            </div>

        </section>
        </div>

            <figure class="article-image">
                <img
                    srcset="../content/images/size/w1000/2022/05/dragonBall.jpg 1000w"
                    sizes="(min-width: 1400px) 1400px, 92vw"
                    src="../content/images/size/w2000/2022/05/dragonBall.jpg"
                    alt="dragon ball"
                />
                    <figcaption>dragon ball</figcaption>
            </figure>

    </header>

    <section class="gh-content gh-canvas">
    <aside class="toc-container">
        <div class="toc"></div>
    </aside>
    <!--kg-card-begin: markdown--><h2 id="quick-start">Quick Start</h2>
<h3 id="extensible-markup-language">Extensible Markup Language</h3>
<p>XML 基本语法（固定格式的声明）：</p>
<ul>
<li>根标签有且只能有一个</li>
<li>允许单双标签</li>
<li>可以嵌套，但是不能交叉嵌套</li>
<li>标签名、属性名建议使用小写字母</li>
<li>属性值必须加引号，单双皆可</li>
</ul>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</code></pre>
<p>Schema 约束：在 XML 文档中，所有标签和属性都必须在约束中有明确的定义。</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">xmlns</td>
<td style="text-align:center">指出当前 XML 文档约束规则的名称空间位置 根据此属性来引用一个具体的名称空间</td>
</tr>
<tr>
<td style="text-align:center">xmlns:xsi</td>
<td style="text-align:center">指出 xmlns 中定义此属性的约束文档</td>
</tr>
<tr>
<td style="text-align:center">xsi:schemaLocation</td>
<td style="text-align:center">在 xsi 名称空间下引用 schemaLocation 属性 指定当前 XML 文档中所用到的约束文档本身的文件的地址</td>
</tr>
</tbody>
</table>
<div style="display:flex;justify-content:center"><img src="https://res.cloudinary.com/dzb9ldnvl/image/upload/v1672565917/blog/zsghost/JavaWeb/xmlnsSchemaLocation_qivjoj.png" width="75%"/></div>
<h3 id="tomcat">Tomcat</h3>
<p>开源应用服务器 Tomcat 常作为承载 Servlet 的容器。</p>
<p>Javaweb 项目并不是将源代码进行部署，而是部署包 Artifact。</p>
<p>IntelliJ IDE 配置：Run -&gt; Edit Configurations -&gt; Edit Configuration Templates -&gt; Tomcat Server -&gt; Local，完成后出现 Application Servers 选项。</p>
<div style="display:flex;justify-content:center"><img src="https://res.cloudinary.com/dzb9ldnvl/image/upload/v1672565950/blog/zsghost/JavaWeb/tomcatMeaning_srlpbt.png" width="70%"/></div>
<p>CentOS 空间：</p>
<ul>
<li>安装 Java &amp; 安装配置 Tomcat</li>
</ul>
<p>Tomcat 要求在服务器上安装 Java 来执行任何 Java Web 的应用程序代码。</p>
<pre><code class="language-shell">yum install java-1.8.0-openjdk-devel.x86_64
</code></pre>
<p>出于安全考虑，Tomcat 应该作为非 root 用户运行。故创建一个运行此服务的新用户和组。</p>
<pre><code class="language-shell"># 创建新 Tomcat 组
sudo groupadd tomcat
# 然后创建一个新 Tomcat 用户使之成为该组的成员
# 其主目录为安装 Tomcat 的 /opt/tomcat,以及一个没有人可以登录该帐账户的 shell /bin/false
sudo useradd -M -s /bin/nologin -g tomcat -d /opt/tomcat tomcat
</code></pre>
<p>安装 Tomcat8 需先下载最新的<a href="https://downloads.apache.org/tomcat/">二进制版本</a>，然后手动配置。</p>
<pre><code class="language-shell">wget https://downloads.apache.org/tomcat/tomcat-8/v8.5.71/bin/apache-tomcat-8.5.71.tar.gz
sudo mkdir /opt/tomcat &amp;&amp; sudo tar xvf apache-tomcat-8*tar.gz -C /opt/tomcat --strip-components=1
</code></pre>
<p>设置对 Tomcat 安装正确访问的权限。</p>
<pre><code class="language-shell">cd /opt/tomcat
# 授予 Tomcat 组对整个安装目录的所有权
sudo chgrp -R tomcat /opt/tomcat
# 授予 Tomcat 组对 conf 目录及其所有内容的读取、执行对目录本身的访问权限
sudo chmod -R g+r conf &amp;&amp; sudo chmod g+x conf
# 设置 Tomcat 用户为 webapps、work、temp、logs 目录的拥有者
sudo chown -R tomcat webapps/ work/ temp/ logs/
</code></pre>
<p>欲将 Tomcat 作为服务运行，所以设置一个 Tomcat Systemd 的单元文件。并通过此脚本告诉服务器以 Tomcat 用户身份运行 Tomcat 服务。</p>
<pre><code class="language-shell">sudo vi /etc/systemd/system/tomcat.service
</code></pre>
<pre><code class="language-shell"># Systemd unit file for tomcat
[Unit]
Description=Apache Tomcat Web Application Container
After=syslog.target network.target

[Service]
Type=forking

Environment=JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.302.b08-0.el7_9.x86_64/jre
Environment=CATALINA_PID=/opt/tomcat/temp/tomcat.pid
Environment=CATALINA_HOME=/opt/tomcat
Environment=CATALINA_BASE=/opt/tomcat
# Environment='CATALINA_OPTS=-Xms512M -Xmx1024M -server -XX:+UseParallelGC'
# Environment='JAVA_OPTS=-Djava.awt.headless=true -Djava.security.egd=file:/dev/./urandom'

ExecStart=/opt/tomcat/bin/startup.sh
ExecStop=/opt/tomcat/bin/shutdown.sh

User=tomcat
Group=tomcat
UMask=0007
RestartSec=10
Restart=always

[Install]
WantedBy=multi-user.target
</code></pre>
<pre><code class="language-shell"># 重新加载 Systemd 以加载 Tomcat 单元文件
sudo systemctl daemon-reload
# 启动 Tomcat 服务
sudo systemctl start tomcat
# 检查服务状态
sudo systemctl status tomcat
# 开启在服务器启动时启动
sudo systemctl enable tomcat
</code></pre>
<p>Local 空间（mac 环境）：</p>
<pre><code class="language-shell"># 指定版本9
$ brew install tomcat@9
# 查看安装地址
$ brew ls tomcat@9
</code></pre>
<pre><code class="language-shell"># 启动、停止Tomcat =&gt; http://localhost:8080/
$ brew services start|stop tomcat@9
</code></pre>
<pre><code class="language-shell"># tomcat 目录结构
$ tree -x /usr/local/Cellar/tomcat@9/9.0.62/libexec
/usr/local/Cellar/tomcat@9/9.0.62/libexec
├── BUILDING.txt
├── CONTRIBUTING.md
├── bin =&gt; 可执行文件目录
├── conf -&gt; ../../../../etc/tomcat@9 =&gt; 配置文件目录
├── lib =&gt; 存放 lib 的目录
├── logs =&gt; 存放日志文件目录
├── temp =&gt; 临时目录
├── webapps =&gt; 项目部署的目录
└── work =&gt; 工作目录
</code></pre>
<p>配置文件：conf 目录下的 server.xml =&gt; Tomcat 启动会占用个三个端口号。</p>
<pre><code class="language-xml">...
&lt;!-- 第22行 --&gt;
&lt;Server port=&quot;8005&quot; shutdown=&quot;SHUTDOWN&quot;&gt;
...
&lt;!-- 第69行 --&gt;
&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;
		   connectionTimeout=&quot;20000&quot;
		   redirectPort=&quot;8443&quot; /&gt;
...
&lt;!-- 第115行 =&gt; 默认被注释 --&gt;
&lt;Connector port=&quot;8009&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; /&gt;
</code></pre>
<h3 id="cookie-session">Cookie &amp; Session</h3>
<p>Cookie 的大小不能超过 4kb，是服务端通知客户端保存键值对的一种技术。</p>
<p>客户端存在的 Cookie 会随着每次的请求发送给服务器。</p>
<p>Cookie 的创建：</p>
<ul>
<li>浏览器没有 Cookie 时向服务端发送请求</li>
<li>服务端创建 Cookie 并通知客户端保存返回的 Cookie</li>
<li>客户端收到响应后查阅 set-cookie：有则修改，无则创建</li>
</ul>
<pre><code class="language-java">// 创建 cookie 对象
Cookie cookie = new Cookie(&quot;cookieKey&quot;,&quot;cookieValue&quot;);
// 通知客户端保存
resp.addCookie(cookie);
</code></pre>
<p>服务端获取 Cookie：<code>req.getCookies()</code></p>
<pre><code class="language-java">// 获取客户端传递的所有 Cookie
Cookie[] cookies = req.getCookies();
for(Cookie cookie:cookies){
    System.out.println(cookie.getName()); // 获取cookie的键
    System.out.println(cookie.getValue()); // 获取cookie的值
}
</code></pre>
<p>服务端对 Cookie 的修改：</p>
<pre><code class="language-java">// 方案一 =&gt; 创建同名 cookie 并回传
Cookie cookie = new Cookie(&quot;cookieKey&quot;,&quot;cookieValue&quot;);
resp.addCookie(cookie);
// 方案二 =&gt; 查找所需修改的 cookie 对象并调用 setValue 赋新值并返回
Cookie cookie = CookieUtils.findCookie(&quot;cookieKey&quot;,req.getCookies());
if(cookie != null){cookie.setValue(&quot;newValue&quot;);resp.addCookie(cookie);}
</code></pre>
<p>Cookie 生命控制：</p>
<table>
<thead>
<tr>
<th style="text-align:center">会话级Cookie</th>
<th style="text-align:center">持久化Cookie</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">服务器端并没有明确指定Cookie的存在时间</td>
<td style="text-align:center">服务器端明确设置了Cookie的存在时间</td>
</tr>
<tr>
<td style="text-align:center">在浏览器端，Cookie数据存在于内存中</td>
<td style="text-align:center">在浏览器端，Cookie数据会被保存到硬盘上</td>
</tr>
<tr>
<td style="text-align:center">只要浏览器还开着，Cookie数据就一直都在</td>
<td style="text-align:center">Cookie在硬盘上存在的时间根据服务器端限定的时间来管控，不受浏览器关闭的影响</td>
</tr>
<tr>
<td style="text-align:center">浏览器关闭，内存中的Cookie数据就会被释放</td>
<td style="text-align:center">持久化Cookie到达了预设的时间会被释放</td>
</tr>
</tbody>
</table>
<pre><code class="language-java">// setMaxAge() =&gt; 设置 cookie 最大生存时间,单位为秒 =&gt; 正数表示在指定的秒数后过期;负值表示浏览器关闭就删除;0表示立刻删除
cookie.setMaxAge(-1); // 默认是-1
</code></pre>
<p>服务端对 Cookie 的路径设置：</p>
<pre><code class="language-java">cookie.setPath(req.getContextPath() + &quot;/xxx&quot;); // 满足路径才会发送此 cookie
</code></pre>
<p>Session 用于存放客户端与服务器之间的会话，以解决 http 无状态的衍生问题。每个客户端都会有一个各自的 Session 会话，常用来保存登录后的信息。</p>
<p>创建与获取 Session：</p>
<pre><code class="language-java">// 第一次调用 =&gt; 创建;后续调用 =&gt; 获取
HttpSession session = req.getSession();
// 判断是否为新 Session =&gt; isNew() =&gt; true =&gt; 新创建
boolean isNew = session.isNew();
// 得到 Session 的会话 id 值 =&gt; 每个会话都有一个唯一 id
String id = session.getId();
</code></pre>
<p>Session 域数据存取：</p>
<pre><code class="language-java">req.getSession().setAttribute(&quot;keyName&quot;,&quot;valueContent&quot;);
Object obj = req.getSession().getAttribute(&quot;keyName&quot;); // valueContent
</code></pre>
<p>Session 生命周期控制：Session 的超时是指客户端两次请求的最大间隔时长。</p>
<pre><code class="language-java">// setMaxInactiveInterval =&gt; 设置 Session 超时时间 =&gt; 超过即销毁 =&gt; 秒为单位
// 常用于修改个别 Session 超时时长
req.getSession().setMaxInactiveInterval(3); // 当前 session 3 秒超时
// getMaxInactiveInterval =&gt; 获取 Session 超时时间 =&gt; 秒为单位
int maxInactiveInterval = req.getSession().getMaxInactiveInterval(); // 默认 1800s =&gt; 30mins
// 当前 Session 会话马上超时
req.getSession().invalidate();
</code></pre>
<pre><code class="language-xml">&lt;!-- tomcat 服务器配置 --&gt;
&lt;session-config&gt;
    &lt;session-timeout&gt;30&lt;/session-timeout&gt;
&lt;/session-config&gt;
</code></pre>
<pre><code class="language-xml">&lt;!-- 当前 web 工程创建出来的所有 session 默认 20 分钟 --&gt;
&lt;!-- web.xml --&gt;
&lt;session-config&gt;
    &lt;session-timeout&gt;20&lt;/session-timeout&gt;
&lt;/session-config&gt;
</code></pre>
<p>Session 底层是基于 Cookie 实现的。无任何 Cookie 的浏览器在访问服务器时，服务器会通过 <code>req.getSession()</code> 创建 Session 会话对象，与此同时也会创建出一个 Cookie 的对象。</p>
<p>此 Cookie 对象的键是 JSESSIONID，值是新建 Session 的 id。后续通过响应将新建 Session 的 id 值返回给客户端，<code>Set-Cookie:JSESSIONID=xxxxx;</code>。</p>
<p>当浏览器接受到数据后会立即创建 Cookie 对象，后续的每次请求会根据 path 路径的设置携带具有 Session id 的 Cookie 给服务器。服务器据 <code>req.getSession()</code> 方法以 Cookie 中的 id 值查询此前创建好的 Session 对象，并返回。</p>
<p>在 Session 存活的时间内删除客户端 Session 中的 Cookie：Cookie 中的 Session id 消失，服务器会新建一个 Session 会话。</p>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="servlet">Servlet</h2>
<blockquote>
<p>A servlet is a Java programming language class used to extend the capabilities of servers that host applications accessed by means of a request-response programming model. Although servlets can respond to any type of request, they are commonly used to extend the applications hosted by web servers. For such applications, Java Servlet technology defines HTTP-specific servlet classes.</p>
</blockquote>
<p>javax.servlet 和 javax.servlet.http 包提供用于编写 servlet 的接口和类。</p>
<p>所有 servlet 都必须实现 Servlet 接口，该接口定义了生命周期方法。</p>
<p>实现通用服务时，可以使用或扩展 Java Servlet API 提供的 GenericServlet 类。</p>
<p>HttpServlet 类提供用于处理 HTTP 特定服务的方法，例如 doGet 和 doPost。</p>
<p>HttpServlet 类 - 继承 -&gt; GenericServlet 类 - 实现 -&gt; Servlet 接口：</p>
<ul>
<li>Servlet 接口负责访问规范</li>
<li>GenericServlet 类在持有 ServletConfig 类引用的同时完成空实现</li>
<li>HttpServlet 类实现上层定义的抽象 service 方法，实现请求分发</li>
</ul>
<p>web.xml 文件用于初始化配置页面（注意：约定大于配置）：</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;
         version=&quot;4.0&quot;&gt;
    &lt;!-- context-param 是上下文参数 =&gt; 属于整个 web 工程 =&gt; Filter 过滤器、Listener 监听器、Servlet 程序皆可访问 --&gt;
    &lt;context-param&gt;
        &lt;param-name&gt;username&lt;/param-name&gt;
        &lt;param-value&gt;zs&lt;/param-value&gt;
    &lt;/context-param&gt;
    &lt;!-- servlet 标签给 tomcat 配置 servlet 程序 --&gt;
    &lt;servlet&gt;
        &lt;!-- servlet-name 标签给 servlet 程序起别名 =&gt; 通常是类名 --&gt;
        &lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;
        &lt;!-- servlet-class 是 servlet 程序全类名 --&gt;
        &lt;servlet-class&gt;com.???.servlets.HelloServlet&lt;/servlet-class&gt;
        &lt;!-- init-param是初始化参数 --&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;username&lt;/param-name&gt;
            &lt;param-value&gt;zs&lt;/param-value&gt;
        &lt;/init-param&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;
    &lt;!-- servlet-mapping 给 servlet 程序配置访问地址 --&gt;
    &lt;servlet-mapping&gt;
        &lt;!-- 通知服务器当前配置的地址是指定的 servlet 程序 --&gt;
        &lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;
        &lt;!-- url-pattern 标签配置访问地址 --&gt;
        &lt;!-- / 解析为 http://ip:port/工程路径 --&gt;
        &lt;!-- 工程路径即是部署 war 包的 Application context --&gt;
        &lt;url-pattern&gt;/hello&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
&lt;/web-app&gt;
</code></pre>
<p>当 Servlet 首次接收请求，会通过构造方法的调用完成实例化，通过 <code>init()</code> 的调用进行初始化，随后执行 <code>service()</code> 开展服务。此后的每一次请求也都是服务，即创建对象后，所有的URL地址匹配的请求都由这同一个对象来处理。当容器关闭时 web 工程停止，所有的 Servlet 实例会通过 <code>destroy()</code> 进行销毁。</p>
<pre><code class="language-java">/* 开发中很少通过实现 Servlet 接口的方式去实现 servlet 程序 */
public class HelloServlet implements Servlet {
    public HelloServlet() {
        System.out.println(&quot;构造器方法执行&quot;);
    }

    @Override
    public void init(ServletConfig servletConfig) throws ServletException {
        System.out.println(&quot;初始化方法执行&quot;);
        /* 测试 ServletConfig 类 */
        // 获取 servlet 程序别名
        System.out.println(servletConfig.getServletName()); // HelloServlet
        // 获取初始化参数 init-param
        System.out.println(servletConfig.getInitParameter(&quot;username&quot;)); // zs
        // 获取 ServletContext 对象
        System.out.println(servletConfig.getServletContext()); // org.apache.catalina.core.ApplicationContextFacade@47d46fad
    }

    @Override
    public ServletConfig getServletConfig() {
        return null;
    }

    @Override
    public void service(ServletRequest servletRequest, ServletResponse servletResponse) throws ServletException, IOException {
        System.out.println(&quot;I got you =&gt; service&quot;);
        // servletRequest 不能直接调用 getMethod，其子接口 HttpServletRequest 才可调用 =&gt; 用于区分请求方法
        // 这里强制类型转换向下转型说明 =&gt; 传递进 service 方法的 servlet 是 HttpServlet,故可以理解为已经过一次向上转型,向上转型不需要强转,向下转型才需强转
        HttpServletRequest httpServletRequest = (HttpServletRequest) servletRequest;
        // 获取请求方式并根据请求方式判断
        String method = httpServletRequest.getMethod();
        if(&quot;GET&quot;.equals(method)) {
            System.out.println(&quot;GET请求&quot;);
            doGet();
        } else if (&quot;POST&quot;.equals(method)) {
            System.out.println(&quot;POST请求&quot;);
            doPost();
        } else {
            System.out.println(&quot;else&quot;);
        }
    }

    private void doPost() {
        System.out.println(&quot;POST请求操作反馈&quot;);
    }

    public void doGet() {
        System.out.println(&quot;GET请求操作反馈&quot;);
    }

    @Override
    public String getServletInfo() {
        return null;
    }

    @Override
    public void destroy() {
        System.out.println(&quot;销毁方法执行&quot;);
    }
}
</code></pre>
<p>当请求出现，<code>service()</code> 会自动响应，根据请求种类决定调用具体的 doXxx 方法。开发中通常直接找 Servlet 子类去继承即可。在 HttpServlet 中的这些方法都是 405 实现风格，需要子类去实现对应方法，否则默认报 405 错误。注意客户端访问不到 WEB-INF 下的内容，但是与其同级资源是可访问的。</p>
<p>Tomcat 默认于首次请求时进行实例化、初始化，以此提高系统的启动速度。若需提高响应速度，可通过 &lt;servlet&gt; 里的 &lt;load-on-startup&gt; 设置启动顺序，数值越小，启动越靠前。</p>
<p>Servlet 在容器中是线程不安全的。若一个线程需要根据实例的成员变量做逻辑判断，那么可能存在某个中间时机，另一个线程改变了被依赖的成员变量值，导致此线程的执行路径发生变化。最好不要在 Servlet 中定义成员变量，若不得不定义成员变量，应尽可能的不去修改成员变量的值，不要根据成员变量的值做逻辑判断。</p>
<h3 id="servletconfig-%E7%B1%BB">ServletConfig 类</h3>
<p>ServletConfig 类是 Servlet 程序的配置信息类，常用于获取 Servlet 程序别名，即 servlet-name 的值；获取初始化参数 init-param；获取 ServletContext 对象。</p>
<p>Tomcat 初始化一个 Servlet 时，会将该 Servlet 的配置信息封装到 ServletConfig 对象中，此时在初始化调用的 <code>init(ServletConfig servletConfig)</code> 方法将 ServletConfig 对象传递给 Servlet。每个 Servlet 维护各自的 ServletConfig。</p>
<p>这里注意一个空指针问题。在继承于 HttpServlet 的类中重写初始化方法后，可能会导致后续 doXxx 方法内的 ServletConfig 对象丢失。这是由于 getServletConfig 方法是在 GenericServlet 中获取的。而 GenericServlet 类也有初始化方法，且在此方法中将 config 进行保存。当子类有初始化且父类也有时，直接调用子类的初始化，导致父类保存操作丢失。</p>
<pre><code class="language-java">public class Demo01Servlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        ServletConfig servletConfig = getServletConfig();
        System.out.println(&quot;I got you.&quot;);
        System.out.println(servletConfig.getServletName());
        // 获取 web.xml 配置的上下文参数 context-param
        ServletContext servletContext = getServletConfig().getServletContext();
        System.out.println(servletContext.getInitParameter(&quot;username&quot;)); // zs
        // 获取当前的工程路径
        System.out.println(servletContext.getContextPath()); // /servlet
        // 获取工程部署后在服务器磁盘上的绝对路径 =&gt; IDEA 整合 tomcat 后, tomcat 被拷贝的副本内容
        System.out.println(servletContext.getRealPath(&quot;/&quot;)); // /Users/???/IdeaProjects/zsJavaWeb/out/artifacts/pro_javaweb_servlet_war_exploded/
        // 存储数据
        // 获取 servletContext 对象
        ServletContext servletContext1 = getServletContext();
        servletContext1.setAttribute(&quot;key1&quot;,&quot;value1&quot;);
        System.out.println(servletContext1.getAttribute(&quot;key1&quot;)); // value1
    }

    @Override
    public ServletConfig getServletConfig() {
        return super.getServletConfig();
    }

    @Override
    public ServletContext getServletContext() {
        return super.getServletContext();
    }

    @Override
    public String getServletInfo() {
        return super.getServletInfo();
    }

    @Override
    public void init(ServletConfig config) throws ServletException {
        super.init(config);
    }
}
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center">servlet 接口方法名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">getServletName()</td>
<td style="text-align:center">获取 servlet-name</td>
</tr>
<tr>
<td style="text-align:center">getServletContext()</td>
<td style="text-align:center">获取 ServletContext 对象</td>
</tr>
<tr>
<td style="text-align:center">getInitParameter()</td>
<td style="text-align:center">获取配置 Servlet 时设置的初始化参数 =&gt; 根据名字获取值</td>
</tr>
<tr>
<td style="text-align:center">getInitParameterNames()</td>
<td style="text-align:center">获取所有初始化参数名组成的 Enumeration 对象</td>
</tr>
</tbody>
</table>
<h3 id="servletcontext-%E7%B1%BB">ServletContext 类</h3>
<p>和 ServletConfig 一样，ServletContext 也是一个接口，其表示 Servlet 上下文对象。一个 web 工程只有一个 ServletContext 对象实例。ServletContext 是一个域对象，即可以像 Map 一样存储数据的对象，其中的域为操作范围。</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">存储</th>
<th style="text-align:center">取出</th>
<th style="text-align:center">删除</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Map</td>
<td style="text-align:center">put</td>
<td style="text-align:center">get</td>
<td style="text-align:center">remove</td>
</tr>
<tr>
<td style="text-align:center">域对象</td>
<td style="text-align:center">setAttribute</td>
<td style="text-align:center">getAttribute</td>
<td style="text-align:center">removeAttribute</td>
</tr>
</tbody>
</table>
<p>ServletContext 常用于获取 web.xml 配置的上下文参数 context-param；获取当前的工程路径；获取工程部署后在服务器磁盘上的绝对路径；存储数据。在工程部署时创建，在工程停止时销毁。</p>
<h3 id="httpservletrequest-%E7%B1%BB">HttpServletRequest 类</h3>
<p>Tomcat 服务器将请求过来的 Http 协议信息解析好封装到 Request 对象中，再传递给 service 方法。HttpServletRequest 对象可获取所有请求的信息。</p>
<table>
<thead>
<tr>
<th style="text-align:center">HttpServletRequest 类常用方法</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">getRequestURI()</td>
<td style="text-align:center">获取请求的资源路径（不包含服务器和端口号）</td>
</tr>
<tr>
<td style="text-align:center">getRequestURL()</td>
<td style="text-align:center">获取请求的统一资源定位符（绝对路径）</td>
</tr>
<tr>
<td style="text-align:center">getRemoteHost()</td>
<td style="text-align:center">获取客户端的ip地址</td>
</tr>
<tr>
<td style="text-align:center">getHeader()</td>
<td style="text-align:center">获取请求头</td>
</tr>
<tr>
<td style="text-align:center">getParameter(&quot;key&quot;)</td>
<td style="text-align:center">获取请求参数</td>
</tr>
<tr>
<td style="text-align:center">getParameterValues(&quot;key&quot;)</td>
<td style="text-align:center">获取请求参数（多值使用）</td>
</tr>
<tr>
<td style="text-align:center">getMethod()</td>
<td style="text-align:center">获取请求方式GET|POST</td>
</tr>
<tr>
<td style="text-align:center">setAttribute(key,value)</td>
<td style="text-align:center">设置域数据</td>
</tr>
<tr>
<td style="text-align:center">getAttribute(key)</td>
<td style="text-align:center">读取域数据</td>
</tr>
<tr>
<td style="text-align:center">getRequestDispatcher()</td>
<td style="text-align:center">获取请求转发对象</td>
</tr>
</tbody>
</table>
<h3 id="httpservletresponse-%E7%B1%BB">HttpServletResponse 类</h3>
<p>每当请求传入 Tomcat，Tomcat 就会创建一个 Response 对象并传递给 Servlet 程序。HttpServletResponse 表示所有相应的信息。字节流 <code>getOutputStram()</code> 传递二进制数据，常用于下载；字符流 <code>getWriter()</code> 常用于回传字符串。注意二者不能同时使用，只能选其一。</p>
<pre><code class="language-java">PrintWriter writer = resp.getWriter();
writer.write(&quot;response content by zs&quot;); // 中文会乱码 =&gt; System.out.println(resp.getCharacterEncoding()); =&gt; ISO-8859-1
</code></pre>
<h3 id="%E8%AF%B7%E6%B1%82%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91">请求转发与重定向</h3>
<ul>
<li>请求转发</li>
</ul>
<p>转发即在请求的处理过程中，Servlet 完成了该阶段的任务，需要把请求转交给下一个 Servlet 程序继续处理，以此协作完成完整功能。</p>
<pre><code class="language-java">// 请求转发必须以斜杠开头 =&gt; 映射到 web 目录
req.getRequestDispatcher(&quot;/servletN&quot;).forward(req,res);
// 注意请求转发能访问 WEB-INF 目录下内容
req.getRequestDispatcher(&quot;/WEB-INF/xxx.html&quot;);
</code></pre>
<ul>
<li>base 标签</li>
</ul>
<p>Html 中位于 &lt;head&gt; 标签内的 &lt;base&gt; 标签用于设置页面相对路径工作时参照的地址。其 href 属性就是参数的地址值。可用做于因转发的地址不变这一特性导致跳转产生相对路径问题的解决方式。</p>
<ul>
<li>重定向</li>
</ul>
<p>重定向即在请求的处理过程中，Servlet 在完成了该处理任务后，以一个响应的方式通知浏览器应另外再访问下一个资源。因之前地址可能被废弃。</p>
<pre><code class="language-java">// 方式一
resp.setStatus(302);
resp.setHeader(&quot;Location&quot;,&quot;http://localhost:8080/xxx&quot;);
// 方式二
resp.sendRedirect(&quot;http://localhost:8080/xxx&quot;);
</code></pre>
<ul>
<li>总结对比</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">转发</th>
<th style="text-align:center">重定向</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">一次请求</td>
<td style="text-align:center">两次请求</td>
</tr>
<tr>
<td style="text-align:center">浏览器地址栏显示的是第一个资源的地址</td>
<td style="text-align:center">浏览器地址栏显示的是第二个资源的地址</td>
</tr>
<tr>
<td style="text-align:center">全程使用的是同一个request对象</td>
<td style="text-align:center">全程使用的是不同的request对象</td>
</tr>
<tr>
<td style="text-align:center">在服务器端完成</td>
<td style="text-align:center">在浏览器端完成</td>
</tr>
<tr>
<td style="text-align:center">目标资源地址由服务器解析</td>
<td style="text-align:center">目标资源地址由浏览器解析</td>
</tr>
<tr>
<td style="text-align:center">目标资源可以在WEB-INF目录下</td>
<td style="text-align:center">目标资源不能在WEB-INF目录下</td>
</tr>
<tr>
<td style="text-align:center">目标资源仅限于本应用内部</td>
<td style="text-align:center">目标资源可以是外部资源</td>
</tr>
</tbody>
</table>
<h2 id="filter-%E8%BF%87%E6%BB%A4%E5%99%A8">Filter 过滤器</h2>
<p>Filter 过滤器是 JavaEE 规范，即接口，作用是拦截请求，过滤响应。常见的应用场景有权限检查、日志操作、事务管理等。</p>
<h3 id="%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B">快速上手</h3>
<pre><code class="language-xml">&lt;!-- web.xml --&gt;
...
&lt;!-- filter 标签用于配置一个过滤器 --&gt;
    &lt;filter&gt;
        &lt;!-- 用于给 filter 起一个别名 --&gt;
        &lt;filter-name&gt;AdminFilter&lt;/filter-name&gt;
        &lt;!-- 配置 filter 全类名 --&gt;
        &lt;filter-class&gt;com.xxx.servlets.AdminFilter&lt;/filter-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;username&lt;/param-name&gt;
            &lt;param-value&gt;zs&lt;/param-value&gt;
        &lt;/init-param&gt;
    &lt;/filter&gt;
    &lt;!-- filter-mapping 配置拦截路径 --&gt;
    &lt;filter-mapping&gt;
        &lt;!-- 表示当前的拦截路径交与的 filter --&gt;
        &lt;filter-name&gt;AdminFilter&lt;/filter-name&gt;
        &lt;!-- 配置拦截路径 --&gt;
        &lt;url-pattern&gt;/&lt;/url-pattern&gt;
    &lt;/filter-mapping&gt;
...
</code></pre>
<pre><code class="language-java">public class AdminFilter implements Filter {
    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
        // 获取 filter 类名称 filter-name
        System.out.println(filterConfig.getFilterName());
        // 获取 filter 中配置的初始化参数 init-param
        System.out.println(filterConfig.getInitParameter(&quot;initParam&quot;));
        // 获取 ServletContext 对象
        System.out.println(filterConfig.getServletContext());
    }

    // doFilter 用于拦截请求 =&gt; 权限检查
    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {
        HttpServletRequest httpServletRequest = (HttpServletRequest) servletRequest;
        HttpSession session = httpServletRequest.getSession();
        Object user = session.getAttribute(&quot;user&quot;);
        if(user == null){
            servletRequest.getRequestDispatcher(&quot;/login.jsp&quot;).forward(servletRequest,servletResponse);
            return;
        } else {
            // 链式调用后输出为 =&gt; Filter1 前置操作 =&gt; Filter2 前置操作 ... =&gt; Filter2 后置操作 =&gt; Filter1 后置操作
            System.out.println(&quot;Filter1 前置操作&quot;);
            System.out.println(Thread.currentThread().getName());
            // 程序继续向下访问用户目标资源
            filterChain.doFilter(servletRequest,servletResponse);
            System.out.println(Thread.currentThread().getName());
            System.out.println(&quot;Filter1 后置操作&quot;);
        }
    }

    @Override
    public void destroy() {

    }
}
</code></pre>
<h3 id="filter-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F">Filter 生命周期</h3>
<p>和 Servlet 生命周期类比，Filter 生命周期的关键区别是在 Web 应用启动时创建对象。</p>
<table>
<thead>
<tr>
<th style="text-align:center">生命周期阶段</th>
<th style="text-align:center">执行时机</th>
<th>执行次数</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">创建对象</td>
<td style="text-align:center">Web应用启动时</td>
<td>一次</td>
</tr>
<tr>
<td style="text-align:center">初始化</td>
<td style="text-align:center">创建对象后</td>
<td>一次</td>
</tr>
<tr>
<td style="text-align:center">拦截请求</td>
<td style="text-align:center">接收到匹配的请求</td>
<td>多次</td>
</tr>
<tr>
<td style="text-align:center">销毁</td>
<td style="text-align:center">Web应用卸载前</td>
<td>一次</td>
</tr>
</tbody>
</table>
<h3 id="filterconfig-%E7%B1%BB">FilterConfig 类</h3>
<p>Tomcat 每次创建 Filter 时，也会创建一个 FilterConfig 类，包含 Filter 配置文件的配置信息。该类的作用是获取 Filter 过滤器的配置内容。</p>
<h3 id="filterchain-%E7%B1%BB">FilterChain 类</h3>
<p>多个 Filter 的拦截范围若存在重合部分，那么这些 Filter 会形成 FilterChain。浏览器请求重合部分对应的目标资源时，会依次经过 FilterChain 中的每个 Filter。</p>
<p>FilterChain 中每一个 Filter 执行的顺序是由 web.xml 中 filter-mapping 配置的顺序决定的。</p>
<p>多个 Filter 过滤器执行时，所有 Filter 和目标资源都默认执行在同一个线程中；多个 Filter 共同执行的时候，其都使用同一个 Request 对象。</p>
<h3 id="filter-%E6%8B%A6%E6%88%AA%E8%B7%AF%E5%BE%84">Filter 拦截路径</h3>
<ul>
<li>
<p>精确匹配 =&gt; 指定被拦截资源的完整路径</p>
</li>
<li>
<p>目录匹配 =&gt; &lt;url-pattern&gt;/xxx/*&lt;/url-pattern&gt;</p>
</li>
<li>
<p>后缀名匹配 =&gt; &lt;url-pattern&gt;*.html&lt;/url-pattern&gt;</p>
</li>
</ul>
<h2 id="listener-%E7%9B%91%E5%90%AC%E5%99%A8">Listener 监听器</h2>
<p>Listener 是 JavaEE 规范，即是接口，作用是监听某种事务的变化，通过回调函数返回给程序去做一些相应处理。</p>
<p>ServletContextListener 监听器可监听 ServletContext 对象的创建和销毁。</p>
<p>ServletContext 对象在 web 工程启动的时候创建，在停止时销毁。该两个阶段分别调用 contextInitialized 和 contextDestroyed。</p>
<pre><code class="language-xml">&lt;!-- web.xml --&gt;
...
&lt;listener&gt;
        &lt;listener-class&gt;com.zairesinatra.servlets.MyServletContextListener&lt;/listener-class&gt;
    &lt;/listener&gt;
...
</code></pre>
<pre><code class="language-java">public class MyServletContextListener implements ServletContextListener {
    @Override
    public void contextInitialized(ServletContextEvent servletContextEvent) {
        System.out.println(&quot;ServletContext 对象创建&quot;);
    }

    @Override
    public void contextDestroyed(ServletContextEvent servletContextEvent) {
        System.out.println(&quot;ServletContext 对象销毁&quot;);
    }
}
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="bugs-%E8%A7%A3%E5%86%B3">Bugs 解决</h2>
<ul>
<li>Web Application 创建问题</li>
</ul>
<p>在 IntelliJ 中 Java 项目下，期望创建一个 JavaWeb 项目，但无法直接在 new modules 中选择 Web Application。可以先通过创建普通 Java 项目，再右键点击 Add Framewoks Support，选中 Web Application 进行补充。其次，也可在 Project Structure settings 选项中 project settings 里的 facets 栏补充一个 Web Application 的项目给指定模块。</p>
<p>后者在保证路径正确的同时，考虑到部署 tomcat 中的并非项目源码，而是部署包 Artifact。故对于 &quot;'web' facet resources are not included in an artifact&quot; 警告，应点击 Create Artifact。</p>
<ul>
<li><a href="https://www.jetbrains.com/help/idea/working-with-module-dependencies.html">Jar 包问题</a></li>
</ul>
<p>不考虑 Maven 的情况下，期望添加包含 Jar 包的 lib 文件夹作为开发依赖。应该先对 lib 指定 Add as library 作为库，然后就可以在 file 中 Project Structure settings 选项对指定的 Modules 添加 Library。</p>
<p>注意检查 Modules 下方的 Library 选项里，lib 包的右侧框内是否添加了所需 Jar 包。若没有添加，则导入的是一个空 dependencies 的 lib 文件夹，仍然会出现 Jar 包搜索不到的异常。这种添加不会出现在 External Libraries 中，不同于 Tomcat 中 Jar 包的导入。</p>
<p>在包含 Jar 包的 lib 文件夹位置方面，除了在项目文件目录下，对于某些模块指定的 Jar 包，也可以放置在 web 文件夹的 WEB—INF 文件夹创建的 lib 内。这种方法的好处是不需要其他的后续操作。</p>
<pre><code class="language-java">// 报错 =&gt; 加载JDBC的驱动出现问题,检查导包情况.
java.lang.ClassNotFoundException: &quot;com.mysql.cj.jdbc.Driver&quot;
</code></pre>
<ul>
<li><a href="https://dev.mysql.com/downloads/connector/j/">MySQL</a> 版本的配置区别</li>
</ul>
<pre><code class="language-java">// JDBC连接Mysql5 =&gt; com.mysql.jdbc.Driver
url:jdbc:mysql://localhost:3306/mysql?useUnicode=true&amp;characterEncoding=UTF-8
// JDBC连接Mysql6+ =&gt; com.mysql.cj.jdbc.Driver =&gt; 需指定时区serverTimezone
url:jdbc:mysql://localhost:3306/mysql?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=GMT%2B8&amp;useSSL=false
</code></pre>
<ul>
<li>Artifacts 中的 Web Application</li>
</ul>
<p>Web Application Exploded 是解压后的 war 包，Web Application Archive 是 web 应用程序的压缩包，也就是 war 包。war 包放入 tomcat 的 webapps 文件夹会被自动解压。在补充 artifact 时建议选择前者。</p>
<ul>
<li>Application context 和 context root</li>
</ul>
<p>Application context 即是 context root，在配置 tomcat 的 deployment 选项中是 &lt;module_name_war_exploded&gt;。</p>
<ul>
<li>重新部署问题</li>
</ul>
<p>对于已经运行过的 Web 项目，若增加目录和文件，那么部署目录有可能不会自动同步过来，从而造成实际运行的效果和期望的不同。在 build artifacts 中选择项目模块的 war 包进行清理 clean，再进行构建 build。</p>
<ul>
<li>404 报错</li>
</ul>
<p>1.访问地址错误，或确实无此资源；2.错误访问 WEB-INF 目录下的资源；3.Web 应用启动的时候，控制台已经抛出异常，导致整个Web应用不可用，此时访问任何资源都是404；4.服务器端缓存。</p>
<table>
<thead>
<tr>
<th style="text-align:center">状态码</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">200</td>
<td style="text-align:center">服务器成功处理了当前请求，成功返回响应</td>
</tr>
<tr>
<td style="text-align:center">302</td>
<td style="text-align:center">重定向</td>
</tr>
<tr>
<td style="text-align:center">400</td>
<td style="text-align:center">[SpringMVC特定环境]请求参数问题</td>
</tr>
<tr>
<td style="text-align:center">403</td>
<td style="text-align:center">没有权限</td>
</tr>
<tr>
<td style="text-align:center">404</td>
<td style="text-align:center">找不到目标资源</td>
</tr>
<tr>
<td style="text-align:center">405</td>
<td style="text-align:center">请求方式和服务器端对应的处理方式不一致</td>
</tr>
<tr>
<td style="text-align:center">406</td>
<td style="text-align:center">[SpringMVC特定环境]请求扩展名和实际返回的响应体类型不一致</td>
</tr>
<tr>
<td style="text-align:center">50X</td>
<td style="text-align:center">服务器端内部错误，通常都是服务器端抛异常了</td>
</tr>
</tbody>
</table>
<ul>
<li>post 请求出现中文乱码</li>
</ul>
<p>处理函数中设置 <code>req.setCharacterEncoding(&quot;utf-8&quot;);</code>。需要注意，在设置字符集前不能进行处理请求参数的操作，否则设置失效。</p>
<ul>
<li>回传字符串出现中文乱码</li>
</ul>
<p>处理函数中设置 <code>resp.setCharacterEncoding(&quot;utf-8&quot;);</code>。需要注意，在设置字符集前不能进行处理返回参数的操作，否则设置失效。同时此举设置的是设置服务器回传的字符集，若浏览器与服务器字符集不统一则也会存在乱码问题。可通过响应头设置浏览器也使用相同字符集。</p>
<pre><code class="language-java">// 设置浏览器字符集
resp.setHeader(&quot;Content-Type&quot;,&quot;text/html;charset=utf-8&quot;);
// 同时设置服务器与客户端使用utf-8
resp.setContentType(&quot;text/html;charset=utf-8&quot;);
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="%E7%BB%93%E6%9D%9F">结束</h2>
<p>本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh"> CC BY-SA 4.0 </a>协议，转载请注明出处！</p>
<!--kg-card-end: markdown-->
    </section>

    <section class="article-comments gh-canvas">
        
        <script src="https://utteranc.es/client.js"
        repo="Zairesinatra/comments-by-utterances"
        issue-term="pathname"
        theme="photon-dark"
        crossorigin="anonymous"
        async>
        </script>
    </section>

</article>
</main>

    <section class="footer-cta outer">
        <div class="inner">
            <h2 class="footer-cta-title">Sign up for more like this.</h2>
            <a class="footer-cta-button" href="index.html#/portal" data-portal>
                <div class="footer-cta-input">Enter your email</div>
                <span>Subscribe</span>
            </a>
        </div>
    </section>



            <aside class="read-more-wrap outer">
                <div class="read-more inner">
                        
<article class="post-card post">

    <a class="post-card-image-link" href="../vim-neovim/index.html">

        <img class="post-card-image"
            srcset="../content/images/size/w1000/2023/03/ScenicViewOfBeachDuringDaytime.jpg 1000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2023/03/ScenicViewOfBeachDuringDaytime.jpg"
            alt="Scenic View Of Beach During Daytime"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../vim-neovim/index.html">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Vim &amp; Neovim
                </h2>
            </header>
                <div class="post-card-excerpt">Vim ninjas count every keystroke!</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2022-12-12">Dec 12, 2022</time>
                <span class="post-card-meta-length">19 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="../design-patterns/index.html">

        <img class="post-card-image"
            srcset="../content/images/size/w1000/2023/03/SixHalogenBulbs.jpg 1000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2023/03/SixHalogenBulbs.jpg"
            alt="Six Halogen Bulbs"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../design-patterns/index.html">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Design Patterns And ...
                </h2>
            </header>
                <div class="post-card-excerpt">"A good programmer is someone who always looks both ways before crossing a one-way street." - Doug Linder</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2022-08-08">Aug 8, 2022</time>
                <span class="post-card-meta-length">35 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="../g-toc-css/index.html">

        <img class="post-card-image"
            srcset="../content/images/size/w1000/2023/03/GlassBottleFilledWithBlackStrawonBrownWoodenTable.jpg 1000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2023/03/GlassBottleFilledWithBlackStrawonBrownWoodenTable.jpg"
            alt="Glass Bottle Filled With Black Straw on Brown Wooden Table"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../g-toc-css/index.html">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    G&amp;TOC&amp;CSS
                </h2>
            </header>
                <div class="post-card-excerpt">TOC 的需求实现以及相关的思考总结。</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2022-05-01">May 1, 2022</time>
                <span class="post-card-meta-length">6 min read</span>
        </footer>

    </div>

</article>
                </div>
            </aside>



    </div>
    <div class="docsearchwrapper"><div id="docsearch"></div></div>
    <div class="arrowup">
      <svg
        version="1.1"
        id="Layer_1"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        x="0px"
        y="0px"
        width="20px"
        height="20px"
        viewBox="0 0 122.883 122.882"
        enable-background="new 0 0 20 20"
        xml:space="preserve"
      >
        <g>
          <path
            d="M0,61.441L0,61.441h0.018c0,16.976,6.872,32.335,17.98,43.443c11.108,11.107,26.467,17.979,43.441,17.979v0.018h0.001 h0.001v-0.018c16.974,0,32.335-6.872,43.443-17.98s17.98-26.467,17.98-43.441h0.018v-0.001V61.44h-0.018 c0-16.975-6.873-32.334-17.98-43.443C93.775,6.89,78.418,0.018,61.443,0.018V0h-0.002l0,0v0.018 c-16.975,0-32.335,6.872-43.443,17.98C6.89,29.106,0.018,44.465,0.018,61.439H0V61.441L0,61.441z M42.48,71.7 c-1.962,1.908-5.101,1.865-7.009-0.098c-1.909-1.962-1.865-5.101,0.097-7.009l22.521-21.839l3.456,3.553l-3.46-3.569 c1.971-1.911,5.117-1.862,7.029,0.108c0.055,0.058,0.109,0.115,0.16,0.175L87.33,64.594c1.963,1.908,2.006,5.047,0.098,7.009 c-1.908,1.963-5.047,2.006-7.01,0.098L61.53,53.227L42.48,71.7L42.48,71.7z"
          />
        </g>
      </svg>
    </div>
    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="../index.html">zairesinatra</a> &copy; 2023</section>
            <nav class="site-footer-nav">
                
            </nav>
            <div><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>
</div>


<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="../assets/built/casper.js%3Fv=58ac320af1"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.min.js"></script>
<script>
  tocbot.init({
    tocSelector: '.toc',
    contentSelector: '.gh-content',
    hasInnerContainers: true
  });
  var tc = document.querySelector(".toc-container");
  if(tc){
    var tch = tc.clientHeight;
    var ah = document.querySelector(".article-header");
    var ahh = ah.clientHeight;
    window.addEventListener("scroll", function () {
    if(document.body.clientWidth > 1170){
      var scrollY = document.documentElement.scrollTop || document.body.scrollTop;
      var ihh = window.innerHeight;
      if(scrollY >= ihh + tch + ahh){
        var ctc = document.querySelector(".toc-container");
        ctc.style.position="sticky";
        ctc.style.position="-webkit-sticky";
        ctc.style.top = "120px";
        ctc.style.marginLeft = "800px";
        ctc.style.minWidth= "260px";
      }
      if(scrollY < tch + ahh -10){
        var ctc = document.querySelector(".toc-container");
        ctc.style.position="";
        ctc.style.top = "";
        ctc.style.marginLeft = "";
      }
    }})
  }
</script>

<script>
  function docSearchFuncMobile(){
    const DocSearchElement = document.querySelector(".DocSearch");
    DocSearchElement.click();
  }
</script>


<!-- searchinghost-easy -->
<!--
<script src="https://cdn.jsdelivr.net/gh/gmfmi/searchinghost-easy@latest/dist/searchinghost-easy-basic.js"></script>
<script>
    new SearchinGhostEasy({
        contentApiKey: 'e93d8b3520ae46be52c9a4b140'
    });
</script>
-->

<!-- Theme Mode -->
<script>
    let currentTheme = localStorage.getItem("theme-color");
    const switchTheme = function () {
        const storedTheme = localStorage.getItem("theme-color") || "theme-light";
        if (
            storedTheme === "theme-dark" &&
            document.getElementsByTagName("html")[0].className !== ""
        ) {
            localStorage.setItem("theme-color", "theme-light");
            currentTheme = localStorage.getItem("theme-color");
            if (currentTheme === "theme-light") {
            document.getElementsByTagName("html")[0].classList.remove("dark-mode");
            document
                .getElementsByClassName("theme-switcher")[0]
                ?.classList.remove("active");
            document
                .getElementsByClassName("toc")[0]
                ?.classList.remove("active");
            }
        } else {
            localStorage.setItem("theme-color", "theme-dark");
            currentTheme = localStorage.getItem("theme-color");
            if (currentTheme === "theme-dark") {
            // console.log(document.getElementById("app"));
            document.getElementsByTagName("html")[0].classList.add("dark-mode");
            document
                .getElementsByClassName("theme-switcher")[0]
                ?.classList.add("active");
            document
                .getElementsByClassName("toc")[0]
                ?.classList.add("active");
            }
        }
    };
    const initTheme = function () {
    const storedTheme = localStorage.getItem("theme-color") || "theme-light";
    if (storedTheme === "theme-dark") {
        document
        .getElementsByClassName("theme-switcher")[0]
        ?.classList.add("active");
        document
        .getElementsByClassName("toc")[0]
        ?.classList.add("active");
        document.getElementsByTagName("html")[0].classList.add("dark-mode");
    }
    };
    initTheme()
</script>

<!-- Arrow up -->
<script>
const arrowup = document.querySelector(".arrowup");
arrowup.addEventListener("click", function() {
  const scrollDuration = 1500; // 滚动持续时间，单位毫秒
    const start = window.pageYOffset; // 当前滚动位置
    const end = 0; // 滚动结束位置
    const distance = end - start; // 滚动距离
    const startTime = performance.now(); // 动画开始时间

    function easeInOutCubic(t) {
      return t < 0.5
        ? 4 * t ** 3
        : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;
    }

    function scrollToTopSmooth(timestamp) {
      const currentTime = timestamp - startTime; // 已经经过的时间
      const progress = currentTime / scrollDuration; // 滚动进度
      const position =
        start + distance * easeInOutCubic(Math.min(progress, 1)); // 当前滚动位置
      window.scrollTo(0, position); // 滚动到新位置

      if (currentTime < scrollDuration) {
        // 如果滚动还未结束，则继续执行动画
        requestAnimationFrame(scrollToTopSmooth);
      }
    }

    requestAnimationFrame(scrollToTopSmooth);
});
</script>

<!-- Algolia DocSearch -->
<style>
.docsearchwrapper{
  display: none;
}
.DocSearch-Container{
  z-index: 9999999;
}
</style>

<script type="text/javascript">
  docsearch({
    appId: "722DYFSYDR",
    apiKey: "5b7d4a36b43ac3d135ca6b83ac715f7e",
    indexName: "zairesinatraio",
    container: document.querySelector("#docsearch"),
    debug: false // Set debug to true if you want to inspect the modal
  });
</script>

</body>
</html>
