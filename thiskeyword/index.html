<!DOCTYPE html>
<html lang="en">
<head>

    <title>📍this keyword and usage instructions</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css%3Fv=3a5c6e94d3.css" />

    <meta name="description" content="默认绑定、隐式绑定、硬绑定、构造函数绑定、箭头函数绑定">
    <link rel="icon" href="../content/images/size/w256h256/2021/07/ghost-orb.png" type="image/png">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="zairesinatra">
    <meta property="og:type" content="article">
    <meta property="og:title" content="📍this keyword and usage instructions">
    <meta property="og:description" content="默认绑定、隐式绑定、硬绑定、构造函数绑定、箭头函数绑定">
    <meta property="og:url" content="https://zairesinatra.github.io//thiskeyword/">
    <meta property="og:image" content="https://zairesinatra.github.io//content/images/2023/02/doraemon.jpg">
    <meta property="article:published_time" content="2019-12-24T12:02:00.000Z">
    <meta property="article:modified_time" content="2023-02-19T20:11:00.000Z">
    <meta property="article:tag" content="Technology growth">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="📍this keyword and usage instructions">
    <meta name="twitter:description" content="默认绑定、隐式绑定、硬绑定、构造函数绑定、箭头函数绑定">
    <meta name="twitter:url" content="https://zairesinatra.github.io//thiskeyword/">
    <meta name="twitter:image" content="https://zairesinatra.github.io//content/images/2023/02/doraemon.jpg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Ziyi Xie">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Technology growth">
    <meta name="twitter:site" content="@xieziyi0422">
    <meta property="og:image:width" content="1920">
    <meta property="og:image:height" content="1080">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "zairesinatra",
        "url": "https://zairesinatra.github.io//",
        "logo": {
            "@type": "ImageObject",
            "url": "https://zairesinatra.github.io//content/images/2021/07/zs-1.JPG",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Ziyi Xie",
        "image": {
            "@type": "ImageObject",
            "url": "https://zairesinatra.github.io//content/images/2021/07/zs-2.JPG",
            "width": 1079,
            "height": 1079
        },
        "url": "https://zairesinatra.github.io//author/ziyi/",
        "sameAs": []
    },
    "headline": "📍this keyword and usage instructions",
    "url": "https://zairesinatra.github.io//thiskeyword/",
    "datePublished": "2019-12-24T12:02:00.000Z",
    "dateModified": "2023-02-19T20:11:00.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://zairesinatra.github.io//content/images/2023/02/doraemon.jpg",
        "width": 1920,
        "height": 1080
    },
    "keywords": "Technology growth",
    "description": "默认绑定、隐式绑定、硬绑定、构造函数绑定、箭头函数绑定",
    "mainEntityOfPage": "https://zairesinatra.github.io//thiskeyword/"
}
    </script>

    <meta name="generator" content="Ghost 5.53">
    <link rel="alternate" type="application/rss+xml" title="zairesinatra" href="../rss/index.html">
    <script defer src="https://cdn.jsdelivr.net/ghost/portal@~2.33/umd/portal.min.js" data-i18n="false" data-ghost="https://zairesinatra.github.io//" data-key="f5d74add11f1d16d3e59c12945" data-api="https://zairesinatra.github.io//ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="f5d74add11f1d16d3e59c12945" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://zairesinatra.github.io//" crossorigin="anonymous"></script>
    
    <link href="https://zairesinatra.github.io//webmentions/receive/" rel="webmention">
    <script defer src="../public/cards.min.js%3Fv=3a5c6e94d3"></script>
    <link rel="stylesheet" type="text/css" href="../public/cards.min.css%3Fv=3a5c6e94d3.css">
    <script defer src="../public/member-attribution.min.js%3Fv=3a5c6e94d3"></script>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NXZH6Q3K52"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NXZH6Q3K52');
</script>

<!-- Ghost Init -->
<style>
.post-template .gh-head,
.page-template .gh-head {
  background: #000000 !important;
}
.site-footer {
  background: #000000 !important;
}
.post-card-tags {
  color: var(--color-secondary-text) !important;
}
.gh-portal-triggerbtn-container.with-label::before {
  display: none !important;
}
/* 需提前，否则闪烁 */
.footer-cta,
a.gh-head-button {
  display: none;
}
.algoliaouterwrapper i svg {
  width: 0;
}
/* 更多内容去除外边距 */
.footer-cta + .read-more-wrap {
  margin-top: unset;
}
</style>

<!-- Resize Pre Area in PrismJS -->
<style>
    pre[class*="language-"].line-numbers{
		font-size: 0.8em;
        background-color: #202324;
    }
    code[class*="language-"] {
        background-color: transparent !important;
    }
</style>

<!-- TOC -->
<style>
    .toc > .toc-list li:first-child {
      margin-top: 8px;
    }
    .toc-list a {
      color: #000000 !important;
      text-decoration: none;
      word-break: break-word;
    }
    .toc > ol, .toc > li{
      font-size: 1.4rem;
    }
    
    .toc.active > .toc-list li:first-child {
      margin-top: 8px;
    }
    .toc.active .toc-list a {
      color: #FFFFFF !important;
      text-decoration: none;
      word-break: break-word;
    }
    .toc.active > ol, .toc.active > li{
      font-size: 1.4rem;
    }
</style>

<!-- ghost style by wkzs -->
<style>
.gh-content > [id]:not(:first-child) {
  margin: 1.5em 0 0;
}
.gh-content > hr + *, .gh-content > blockquote + * {
  margin-top: max(1.1rem, 16px) !important;
}
.gh-content > [id]:not(:first-child) {
  margin: 1em 0 0;
}
.gh-content > * + * {
  margin-top: max(1.6vmin, 16px);
  margin-bottom: 0;
}
.gh-content > blockquote:not([class]), .gh-content > ol, .gh-content > ul, .gh-content > dl, .gh-content > p {
    font-family: var(--font-serif);
    font-weight: 400;
    font-size: 1.4rem !important;
  	line-height: 1.8em !important;
    margin-top: 1.6rem;
}
</style>

<!-- Theme Change -->
<style>
@keyframes slideUp {
  from {
    bottom: 100px;
    opacity: 0;
  }
  to {
    bottom: 0;
    opacity: 1;
  }
}
.theme-switcher-wrap {
  width: 42px;
  height: 24px;
  text-align: right;
}
@media (max-width: 767px) {
  .gh-head-open .theme-switcher-wrap {
    width: 42px;
    height: 24px;
    text-align: right;
    animation: slideUp 1s ease-in-out forwards;
  }
}
.theme-switcher {
  display: inline-block;
  cursor: pointer;
}
.switch-path {
  width: 42px;
  height: 24px;
  border-radius: 10px;
  background-color: #f2f2f2;
  border: #dddfe6 1px solid;
}
.switch-path > .switch-handle {
  background-color: #ffffff;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  transition: all 0.3s ease-in-out;
}
.switch-handle .dark-icon {
  visibility: hidden;
  display: none;
}
.theme-switcher.active .switch-path {
  background-color: #555;
}
.theme-switcher.active .switch-handle {
  transform: translateX(20px);
  background-color: #101115;
}
.theme-switcher.active .switch-handle .light-icon {
  visibility: hidden;
}
.theme-switcher.active .switch-handle .dark-icon {
  visibility: visible;
  display: block;
}
</style>

<!-- Drak Theme Ghost CSS -->
<style>
.dark-mode .gh-content > blockquote:not([class])::before {
  background: #FFFFFF !important;
}
</style>

<!-- Arrow up -->
<style>
.arrowup {
  position: fixed;
  width: 50px;
  height: 50px;
  left: 35px;
  bottom: 3.1rem;
  z-index: 99;
  background-color: #15171a;
  display: flex;
  justify-content: center;
  align-items: center;
  border-radius: 10px;
  cursor: pointer;
  display: none;
}
.arrowup svg {
  fill: #ffffff;
}
.arrowup:hover {
  opacity: 0.8;
}
</style>

<!-- 2023 => prismjs -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zairesinatra/GhostCDN@1.0.0/prism.css"/>

<!-- tocbot -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.css">

<!-- docsearch -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/></pre></li><style>:root {--ghost-accent-color: #15171A;}</style>

</head>
<body class="post-template tag-technology-growth is-head-left-logo has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <div class="gh-head-inner inner">
            <div class="gh-head-brand">
                <a class="gh-head-logo" href="../index.html">
                        <img src="../content/images/2021/07/zs-1.JPG" alt="zairesinatra">
                </a>
                <button class="gh-search gh-icon-btn" onclick="docSearchFuncMobile()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <button class="gh-burger"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="../index.html">Home</a></li>
    <li class="nav-welcome"><a href="../welcome/index.html">Welcome</a></li>
    <li class="nav-author"><a href="../selfintro/index.html">Author</a></li>
    <li class="nav-tags"><a href="../tags/index.html">Tags</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                <div class="gh-head-actions">
                    <div class="theme-switcher-wrap">
                    <div class="theme-switcher" onclick="switchTheme()">
                        <div class="switch-path">
                        <div class="switch-handle">
                            <svg viewBox="0 0 24 24" class="dark-icon">
                            <path
                                d="M11.01 3.05C6.51 3.54 3 7.36 3 12a9 9 0 0 0 9 9c4.63 0 8.45-3.5 8.95-8c.09-.79-.78-1.42-1.54-.95A5.403 5.403 0 0 1 11.1 7.5c0-1.06.31-2.06.84-2.89c.45-.67-.04-1.63-.93-1.56z"
                                fill="#CFD3DC"
                            ></path>
                            </svg>
                            <svg viewBox="0 0 24 24" class="light-icon">
                            <path
                                d="M6.05 4.14l-.39-.39a.993.993 0 0 0-1.4 0l-.01.01a.984.984 0 0 0 0 1.4l.39.39c.39.39 1.01.39 1.4 0l.01-.01a.984.984 0 0 0 0-1.4zM3.01 10.5H1.99c-.55 0-.99.44-.99.99v.01c0 .55.44.99.99.99H3c.56.01 1-.43 1-.98v-.01c0-.56-.44-1-.99-1zm9-9.95H12c-.56 0-1 .44-1 .99v.96c0 .55.44.99.99.99H12c.56.01 1-.43 1-.98v-.97c0-.55-.44-.99-.99-.99zm7.74 3.21c-.39-.39-1.02-.39-1.41-.01l-.39.39a.984.984 0 0 0 0 1.4l.01.01c.39.39 1.02.39 1.4 0l.39-.39a.984.984 0 0 0 0-1.4zm-1.81 15.1l.39.39a.996.996 0 1 0 1.41-1.41l-.39-.39a.993.993 0 0 0-1.4 0c-.4.4-.4 1.02-.01 1.41zM20 11.49v.01c0 .55.44.99.99.99H22c.55 0 .99-.44.99-.99v-.01c0-.55-.44-.99-.99-.99h-1.01c-.55 0-.99.44-.99.99zM12 5.5c-3.31 0-6 2.69-6 6s2.69 6 6 6s6-2.69 6-6s-2.69-6-6-6zm-.01 16.95H12c.55 0 .99-.44.99-.99v-.96c0-.55-.44-.99-.99-.99h-.01c-.55 0-.99.44-.99.99v.96c0 .55.44.99.99.99zm-7.74-3.21c.39.39 1.02.39 1.41 0l.39-.39a.993.993 0 0 0 0-1.4l-.01-.01a.996.996 0 0 0-1.41 0l-.39.39c-.38.4-.38 1.02.01 1.41z"
                                fill="#606266"
                            ></path>
                            </svg>
                        </div>
                        </div>
                    </div>
                    </div>
                </div>
                    <button class="gh-search gh-icon-btn" onclick="docSearchFuncMobile()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                    <div class="gh-head-members">
                                <a class="gh-head-link" href="index.html#/portal/signin" data-portal="signin">Sign in</a>
                                <a class="gh-head-button" href="index.html#/portal/signup" data-portal="signup">Subscribe</a>
                    </div>
            </div>
        </div>
    </header>

    <div class="site-content">
        



<main id="site-main" class="site-main">
<article class="article post tag-technology-growth featured ">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
                <span class="post-card-primary-tag">
                    <a href="../tag/technology-growth/index.html">Technology growth</a>
                </span>
                <span class="post-card-featured"><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M4.49365 4.58752C3.53115 6.03752 2.74365 7.70002 2.74365 9.25002C2.74365 10.6424 3.29678 11.9778 4.28134 12.9623C5.26591 13.9469 6.60127 14.5 7.99365 14.5C9.38604 14.5 10.7214 13.9469 11.706 12.9623C12.6905 11.9778 13.2437 10.6424 13.2437 9.25002C13.2437 6.00002 10.9937 3.50002 9.16865 1.68127L6.99365 6.25002L4.49365 4.58752Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
</svg> Featured</span>
        </div>

        <h1 class="article-title">📍this keyword and usage instructions</h1>

            <p class="article-excerpt">默认绑定、隐式绑定、硬绑定、构造函数绑定、箭头函数绑定</p>

        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../author/ziyi/index.html" class="author-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2021/07/zs-2.JPG" alt="Ziyi Xie" />
                    </a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="../author/ziyi/index.html">Ziyi Xie</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2019-12-24">Dec 24, 2019</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 11 min read</span>
                </div>
            </div>

        </section>
        </div>

            <figure class="article-image">
                <img
                    srcset="../content/images/size/w2000/2023/02/doraemon.jpg 2000w"
                    sizes="(min-width: 1400px) 1400px, 92vw"
                    src="../content/images/size/w2000/2023/02/doraemon.jpg"
                    alt="doraemon"
                />
                    <figcaption>doraemon</figcaption>
            </figure>

    </header>

    <section class="gh-content gh-canvas">
        <aside class="toc-container">
            <div class="toc"></div>
        </aside>
        <!--kg-card-begin: html--><iframe src="https://open.spotify.com/embed/playlist/3ntu3ma2CyfXymme1Vub4t?theme=0" width="100%" height="180" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe><!--kg-card-end: html--><!--kg-card-begin: markdown--><h2 id="%E9%BB%98%E8%AE%A4%E7%BB%91%E5%AE%9A">默认绑定</h2>
<p>通常是纯粹或独立函数调用的情况下，这时 this 指向全局对象，在浏览器中为 window，而 Node.js 中为 global。当然，在纯粹函数调用时由于严格模式不允许默认绑定，this 为未定义的 undefined。可以把这条规则看作是无法应用其他规则时的默认规则。</p>
<pre><code class="language-js">// 单独使用;不论是否严格
console.log(this) // Window {0: Window, window: Window, self: Window, document: document, name: '', location: Location,…}
</code></pre>
<pre><code class="language-js">// 函数调用;非严格模式
global.x = &quot;zs&quot;;
function zsall() {
	console.log(this.x);
}
zsall();  // zs
</code></pre>
<pre><code class="language-js">// 函数调用;严格模式
&quot;use strict&quot;;
function usestrictzsall() {
	console.log(this);
 }
usestrictzsall() // undefined
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="%E9%9A%90%E5%BC%8F%E7%BB%91%E5%AE%9A">隐式绑定</h2>
<p>另一条需要考虑的规则是调用位置是否有上下文对象，或者说是否被某个对象拥有或者包含，在作为对象方法的调用场景时，this 指向方法的调用者。不过这种说法可能会造成一些误导。</p>
<pre><code class="language-js">// 经典题
global.name = &quot;Kakashi&quot;;
function a () {
	var name = 'Sasuke';
	console.log(this.name);
}
function d (i) { // 形参i实际是函数
	return i() // 函数直接执行形参i
}
var b = {
	name: 'Naruto',
	detail: function() {
		console.log(this.name);
	},
	// 有括号需要执行
	// b.teacher =&gt; f(){return {function(){console.log(this.name)}}}
	// b.teacher() =&gt; f(){console.log(this.name)}
	teacher: function() {
		return function() {
			console.log(this.name);
		};
	},
}
var c = b.detail;
b.a = a; // 给b定义a属性
var e = b.teacher();
// global对象可以在全局作用域里通过使用 this 访问到
a(); // 纯粹的函数调用 global -- Kakashi
// ---
// b的第一条方法赋值给了变量c,那么真正的调用者是c
c(); // b的第一条方法看作普通函数赋值给c,已经和b没有关系了 -- Kakashi
// ---
b.a(); // Naruto
// ---
// 看着指向b,实际上是b.detail方法看成一个值用在d里面,实际执行的是全局范围的函数d,所以也是指向全局
d(b.detail) // Kakashi
e(); // 赋值了b.teacher()的输出=&gt; var e = f(){console.log(this.name)} =&gt; 全局 -- Kakashi
</code></pre>
<p>一方面，对象属性引用链中只有最顶层或者说<u>最后一层</u>会影响调用位置。另一方面，最常见的 this 绑定问题就是被隐式绑定的函数会丢失绑定对象，也就是说它会应用默认绑定，从而把 this 绑定到全局对象或者 undefined 上，取决于是否是严格模式。</p>
<pre><code class="language-javascript">function foo() { console.log( this.a );}
var obj2 = {
    a: 42,
    foo: foo
};
var obj1 = {
    a: 2,
    obj2: obj2
};
obj1.obj2.foo(); // 42
</code></pre>
<pre><code class="language-javascript">// ex1 =&gt; 引用
// 虽然 bar 是 obj.foo 的一个引用,但是实际上它引用的是 foo 函数本身,因此此时的 bar() 其实是一个不带任何修饰的函数调用,因此应用了默认绑定.
function foo() { console.log( this.a );}
var obj = {
    a: 2,
    foo: foo
};
var bar = obj.foo; // 函数别名!
var a = &quot;oops, global&quot;; // a 是全局对象的属性
bar(); // &quot;oops, global&quot;
// ex2 =&gt; 传入回调
// 参数传递其实就是一种隐式赋值,因此传入函数时也会被隐式赋值
function foo() {
    console.log( this.a );
}
function doFoo(fn) {
    // fn 其实引用的是 foo 
    fn(); // &lt;-- 调用位置!
}
var obj = {
    a: 2,
    foo: foo
};
var a = &quot;oops, global&quot;; // a 是全局对象的属性
doFoo( obj.foo ); // &quot;oops, global&quot;
// ex3 =&gt; 把函数传入语言内置的函数
function foo() {
    console.log( this.a );
}
var obj = {
    a: 2,
    foo: foo
};
var a = &quot;oops, global&quot;; // a 是全局对象的属性
setTimeout( obj.foo, 100 ); // &quot;oops, global&quot;
</code></pre>
<p>除此之外，还有一种情况 this 的行为会出乎意料，即调用回调函数的函数可能会修改 this。在一些流行的 JavaScript 库中事件处理器常会把回调函数的 this 强制绑定到触发事件的 DOM 元素上。这在一些情况下可能很有用。</p>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="%E7%A1%AC%E7%BB%91%E5%AE%9A">硬绑定</h2>
<p>隐式绑定时，必须在一个对象内部包含一个指向函数的属性，并通过这个属性间接引用函数，从而把 this 隐式绑定到这个对象上。那么如果不想在对象内部包含函数引用，而想在某个对象上强制调用函数，那么就需要显示绑定。</p>
<p>硬绑定是一种显式的<u>强制绑定</u>，使用 <code>apply()</code> 或者是 <code>call()</code> 改变函数的调用对象（将另一个对象作为参数调用对象方法）。第一个参数就表示<strong>改变后</strong>的调用这个函数的对象。此时，this 指的就是这第一个参数。也就是说，将<u>所用方法指定绑定到目的对象中</u>。</p>
<p>如果传入了一个原始值（字符串类型、布尔类型或者数字类型）来当作 this 的绑定对象，这个原始值会被转换成其对象形式（也就是 new String(..)、new Boolean(..) 或者 new Number(..)）。这通常被称为“装箱”。</p>
<pre><code class="language-javascript">function foo() {
    console.log( this.a );
}
var obj = { a:2 };
var bar = function() {
    foo.call( obj );
};
bar(); // 2
setTimeout( bar, 100 ); // 2
// 硬绑定的 bar 不可能再修改它的 this
bar.call( window ); // 2
</code></pre>
<pre><code class="language-javascript">// 硬绑定的典型应用场景就是创建一个包裹函数,传入所有的参数并返回接收到的所有值.
function foo(something) {
    console.log( this.a, something );
    return this.a + something;
}
var obj = {
    a:2
};
var bar = function() {
    return foo.apply( obj, arguments );
};
var b = bar( 3 ); // 2 3
console.log( b ); // 5
// ---------
// 另一种使用方法是创建一个可以重复使用的辅助函数
function foo(something) {
    console.log( this.a, something );
    return this.a + something;
}
// 简单的辅助绑定函数
function bind(fn, obj) {
    return function() {
        return fn.apply( obj, arguments );
    };
}
var obj = {
    a:2
};
var bar = bind( foo, obj );
var b = bar( 3 ); // 2 3
console.log( b ); // 5
</code></pre>
<pre><code class="language-js">// 硬绑定call与apply皆可
var zswant = {
	fruit: 'coco',
	sayName: function() {
		console.log('zs想吃' + this.fruit)
	}
} 
var fruit1= {
	fruit: 'watermelon'
}
var fruit2 = {
	fruit: 'Strawberry'
}
// call调用对象的方法
zswant.sayName.call(fruit1) // zs想吃watermelon
zswant.sayName.apply(fruit2) // zs想吃Strawberry
</code></pre>
<p>注意这里 <code>apply()</code> 或 <code>call()</code> 的参数为空、null 和 undefined 时，默认传入全局对象。且由于硬绑定是一种非常常用的模式，所以在 ES5 中提供了内置的方法 Function.prototype. bind。</p>
<pre><code class="language-js">globalThis.fruit = 'hahaha'
// 硬绑定call与apply皆可
var zswant = {
	fruit: 'coco',
	sayName: function() {
		console.log('zs想吃' + this.fruit)
	}
} 
var fruit1= {
	fruit: 'watermelon'
}
var fruit2 = {
	fruit: 'Strawberry'
}
// call调用对象的方法
zswant.sayName.call() // zs想吃watermelon
zswant.sayName.apply() // zs想吃Strawberry
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="new-%E7%BB%91%E5%AE%9A">new 绑定</h2>
<p>在传统的面向类的语言中，“构造函数”是类中的一些特殊方法，使用 new 初始化类时会调用类中的构造函数。通过构造函数生成新的对象。那么 this 指这个新对象。</p>
<blockquote>
<p>首先重新定义一下 JavaScript 中的“构造函数”。在 JavaScript 中，构造函数只是一些使用 new 操作符时被调用的函数。它们并不会属于某个类，也不会实例化一个类。实际上，它们甚至都不能说是一种特殊的函数类型，只是被 new 操作符调用的普通函数而已。——《你不知道的 javascript 上卷》</p>
</blockquote>
<blockquote>
<p>使用 new 来调用函数，或者说发生构造函数调用时，会自动执行下面的操作。</p>
<ol>
<li>创建(或者说构造)一个全新的对象。</li>
<li>这个新对象会被执行[[原型]]连接。</li>
<li>这个新对象会绑定到函数调用的this。</li>
<li>如果函数没有返回其他对象，那么new表达式中的函数调用会自动返回这个新对象。</li>
</ol>
</blockquote>
<pre><code class="language-js">function dev (name) {
	this.name = 'zs'; // 注意这里的不同
	this.sayName = function () {
		console.log('dev是' + this.name)
	}
}
var name = &quot;zsxzy&quot; // 即使有同名变量
var zy = new dev('zss')
zy.sayName(); // dev是zs
</code></pre>
<pre><code class="language-js">function dev (name) {
	this.name = name; // 构造函数实例化传参且传入
	this.sayName = function () {
		console.log('dev是' + this.name)
	}
}
var name = &quot;zsxzy&quot; // 即使有同名变量
var zy = new dev('zss') // 输入进行变量实例化,这时this与实例化后新对象捆绑
zy.sayName(); // dev是zss
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E7%BB%91%E5%AE%9A">箭头函数绑定</h2>
<p>箭头函数的 this 对象，就是<strong>外部环境所在的作用域指向的对象</strong>，而不是使用时所在的作用域指向的对象，即并不是由自身决定（并不属于自身）的。</p>
<pre><code class="language-js">var name = 'window'; 
var A = {
name: 'A',
sayHello: () =&gt; {
    console.log(this.name)
    }
}
A.sayHello(); // window
</code></pre>
<pre><code class="language-js">var name = 'window';
var A = {
    name: 'A',
    sayHello: function(){
        return arrow = () =&gt; console.log(this.name) // 返回箭头函数
    }
}
var sayHello = A.sayHello();
sayHello(); // A 
var B = {
   name: 'B'
}
sayHello.call(B); // A
sayHello.apply(); // A
// sayHello.bind() 不会输出结果 =&gt; bind方法返回的是綁绑定 this 后的原函数
sayHello.bind()(); // A
</code></pre>
<p>箭头函数在定义时就完成了 <code>this</code> 绑定，执行时调用位置、用 <code>call()</code>、<code>apply()</code>、<code>bind()</code> 都无法更改。</p>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="%E7%BB%8F%E5%85%B8%E9%A2%98">经典题</h2>
<h3 id="this-%E7%9B%B8%E5%85%B3">this 相关</h3>
<pre><code class="language-javascript">function foo(el) { console.log( el, this.id ); }
var obj = { id: &quot;okk&quot; };
// forEach(callback(currentValue [, index [, array]])[, thisArg])
[1, 2, 3].forEach( foo, obj ); // 1 okk  2 okk  3 okk
</code></pre>
<pre><code class="language-javascript">var A = function( name ){ this.name = name; };
var B = function(){ A.apply(this, arguments); };
B.prototype.getName = function(){ return this.name; };
var b = new B('okk');
console.log( b.getName() ); // okk
</code></pre>
<h3 id="%E6%89%8B%E5%86%99-bind%E3%80%81call%E3%80%81apply">手写 Bind、Call、Apply</h3>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind?ref=localhost">Function.prototype.bind</a> =&gt; 适合于事件处理、回调函数和定时器</li>
</ul>
<p><code>bind</code> 被调用时，会创建一个新函数，这个新函数的 this 被指定为 <code>bind</code> 的第一个参数，余下的参数将作为新函数的参数，供调用时使用。</p>
<blockquote>
<p>绑定函数也可以使用 new 运算符构造，其会表现为目标函数已经被构建完毕。提供的 this 值会被忽略，但前置参数仍会提供给模拟函数。</p>
</blockquote>
<pre><code class="language-javascript">Function.prototype.myBind = function (ctx = globalThis) {
  // bind 传入 this 和 args
  const fn = this; // myBind 方法是被待改变 this 指向的函数调用
  const args = Array.from(arguments).slice(1); // Array.prototype.slice.call(arguments, 1) 也可
  const newFunc = function () {
    const newArgs = args.concat(...arguments); // 考虑到 bind 实际具有柯里化特性 (arg01)(arg02)
    if (this instanceof newFunc) {
      // instanceof 运算符用于检测构造函数的 prototype 属性是否出现在某个实例对象的原型链上
      fn.apply(this, newArgs); // 对调用 bind 函数产生的新函数实例化 new 的情况
    } else {
      fn.apply(ctx, newArgs);
    }
  };
  newFunc.prototype = Object.create(fn.prototype); // 将实例与原型对象关联 =&gt; 可访问待改变 this 指向函数原型链上的属性
  return newFunc;
};
</code></pre>
<pre><code class="language-javascript">/* Test Code */
const me = {name: &quot;ok&quot;}, you = {name: &quot;okk&quot;};
function say(){console.log(`${this.name || 'default'}`)}
say.prototype.associationPropertiesTest = &quot;testOk&quot;
const meSay = say.myBind(me), youSay = say.myBind(you);
meSay();
youSay();
const mesay = new meSay();
console.log(mesay.associationPropertiesTest);
</code></pre>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/call?ref=localhost">Function.prototype.call</a> =&gt; 适合临时改变函数运行环境</li>
</ul>
<p><code>call</code> 方法使用一个指定的 this 和单独给出的一个或多个参数来调用一个函数。</p>
<pre><code class="language-javascript">Function.prototype.myCall = function (ctx = globalThis) {
  // ctx 调用方法触发 this 绑定为 ctx
  const key = Symbol(&quot;key&quot;);
  ctx[key] = this;
  const args = [...arguments].slice(1);
  const res = ctx[key](...args);
  delete ctx[key];
  return res;
};
</code></pre>
<pre><code class="language-javascript">/* Test Code */
const me = { name: &quot;ok&quot; };
function say() { console.log(`${this.name || &quot;default&quot;}`); }
say.myCall(me);
</code></pre>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/apply?ref=localhost">Function.prototype.apply</a> =&gt; 适合临时改变函数运行环境</li>
</ul>
<p><code>apply</code> 方法调用一个具有给定 this 值的函数，以及以一个数组（或一个类数组对象）的形式提供的参数。</p>
<pre><code class="language-javascript">Function.prototype.myApply = function(ctx = globalThis){ // ctx 调用方法触发 this 绑定为 ctx
  const key = Symbol(&quot;key&quot;);
  ctx[key] = this;
  let res;
  if(arguments[1]){
    res = ctx[key](...arguments[1]);
  } else {
    res = ctx[key]()
  }
  delete ctx[key];
  return res;
}
</code></pre>
<pre><code class="language-javascript">/* Test Code */
const me = { name: &quot;ok&quot;}
function say(){ console.log(`${this.name || &quot;default&quot;}`) };
say.myApply(me)
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="%E6%80%BB%E7%BB%93">总结</h2>
<ul>
<li>this 是 JavaScript 中的一个关键字，是函数运行时所在的环境对象</li>
<li>根据使用场合存在不同的 this 绑定方式，但是在执行期间不能被赋值。此外，需要注意严格模式和非严格模式之间的使用差别</li>
<li>call、apply、bind 都可以改变函数的 this 指向</li>
<li>call、apply、bind 首个参数都是 this 要指向的对象，若没有这个参数或参数为 undefined 或 null，则默认指向全局 window</li>
<li>call、apply、bind 都可以传参，但 apply 是数组，call 是参数列表，apply 和 call 是一次性传入参数，而 bind 可以分为多次传入</li>
<li>bind 是返回绑定 this 之后的函数，便于稍后调用，而 apply、call 则是立即执行</li>
</ul>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h2 id="%E7%BB%93%E6%9D%9F">结束</h2>
<p>本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh?ref=localhost"> CC BY-SA 4.0 协议 </a>，转载请注明出处！</p>
<!--kg-card-end: markdown-->
    </section>

        <section class="article-comments gh-canvas">
        
        <script src="https://utteranc.es/client.js"
        repo="Zairesinatra/comments-by-utterances"
        issue-term="pathname"
        theme="photon-dark"
        crossorigin="anonymous"
        async>
        </script>
        
    </section>

</article>
</main>

    <section class="footer-cta outer">
        <div class="inner">
            <h2 class="footer-cta-title">Sign up for more like this.</h2>
            <a class="footer-cta-button" href="index.html#/portal" data-portal>
                <div class="footer-cta-input">Enter your email</div>
                <span>Subscribe</span>
            </a>
        </div>
    </section>



            <aside class="read-more-wrap outer">
                <div class="read-more inner">
                        
<article class="post-card post">

    <a class="post-card-image-link" href="../vim-neovim/index.html">

        <img class="post-card-image"
            srcset="../content/images/size/w600/2023/03/ScenicViewOfBeachDuringDaytime.jpg 600w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2023/03/ScenicViewOfBeachDuringDaytime.jpg"
            alt="Scenic View Of Beach During Daytime"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../vim-neovim/index.html">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Vim &amp; Neovim
                </h2>
            </header>
                <div class="post-card-excerpt">Vim ninjas count every keystroke!</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2022-12-12">Dec 12, 2022</time>
                <span class="post-card-meta-length">19 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="../design-patterns/index.html">

        <img class="post-card-image"
            srcset="../content/images/size/w600/2023/03/SixHalogenBulbs.jpg 600w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2023/03/SixHalogenBulbs.jpg"
            alt="Six Halogen Bulbs"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../design-patterns/index.html">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Design Patterns And ...
                </h2>
            </header>
                <div class="post-card-excerpt">"A good programmer is someone who always looks both ways before crossing a one-way street." - Doug Linder</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2022-08-08">Aug 8, 2022</time>
                <span class="post-card-meta-length">35 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="../g-toc-css/index.html">

        <img class="post-card-image"
            srcset="../content/images/size/w600/2023/03/GlassBottleFilledWithBlackStrawonBrownWoodenTable.jpg 600w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2023/03/GlassBottleFilledWithBlackStrawonBrownWoodenTable.jpg"
            alt="Glass Bottle Filled With Black Straw on Brown Wooden Table"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../g-toc-css/index.html">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    G&amp;TOC&amp;CSS
                </h2>
            </header>
                <div class="post-card-excerpt">TOC 的需求实现以及相关的思考总结。</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2022-05-01">May 1, 2022</time>
                <span class="post-card-meta-length">7 min read</span>
        </footer>

    </div>

</article>
                </div>
            </aside>



    </div>

    <div class="docsearchwrapper"><div id="docsearch"></div></div>
    <div class="arrowup">
      <svg
        version="1.1"
        id="Layer_1"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        x="0px"
        y="0px"
        width="20px"
        height="20px"
        viewBox="0 0 122.883 122.882"
        enable-background="new 0 0 20 20"
        xml:space="preserve"
      >
        <g>
          <path
            d="M0,61.441L0,61.441h0.018c0,16.976,6.872,32.335,17.98,43.443c11.108,11.107,26.467,17.979,43.441,17.979v0.018h0.001 h0.001v-0.018c16.974,0,32.335-6.872,43.443-17.98s17.98-26.467,17.98-43.441h0.018v-0.001V61.44h-0.018 c0-16.975-6.873-32.334-17.98-43.443C93.775,6.89,78.418,0.018,61.443,0.018V0h-0.002l0,0v0.018 c-16.975,0-32.335,6.872-43.443,17.98C6.89,29.106,0.018,44.465,0.018,61.439H0V61.441L0,61.441z M42.48,71.7 c-1.962,1.908-5.101,1.865-7.009-0.098c-1.909-1.962-1.865-5.101,0.097-7.009l22.521-21.839l3.456,3.553l-3.46-3.569 c1.971-1.911,5.117-1.862,7.029,0.108c0.055,0.058,0.109,0.115,0.16,0.175L87.33,64.594c1.963,1.908,2.006,5.047,0.098,7.009 c-1.908,1.963-5.047,2.006-7.01,0.098L61.53,53.227L42.48,71.7L42.48,71.7z"
          />
        </g>
      </svg>
    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="../index.html">zairesinatra</a> &copy; 2023</section>
            <nav class="site-footer-nav">
                
            </nav>
            <div class="gh-powered-by"><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>


<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="../assets/built/casper.js%3Fv=3a5c6e94d3"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

<!-- searchinghost-easy -->
<!--
<script src="https://cdn.jsdelivr.net/gh/gmfmi/searchinghost-easy@latest/dist/searchinghost-easy-basic.js"></script>
<script>
    new SearchinGhostEasy({
        contentApiKey: 'e93d8b3520ae46be52c9a4b140'
    });
</script>
-->

<!-- Theme Mode -->
<script>
const switchTheme = function() {
  const storedTheme = localStorage.getItem("theme-color") || "theme-light";
  if (storedTheme === "theme-dark") {
    localStorage.setItem("theme-color", "theme-light");
    document.documentElement.classList.remove("dark-mode");
    document.querySelector(".theme-switcher")?.classList.remove("active");
    document.querySelector(".toc")?.classList.remove("active");
  } else {
    localStorage.setItem("theme-color", "theme-dark");
    document.documentElement.classList.add("dark-mode");
    document.querySelector(".theme-switcher")?.classList.add("active");
    document.querySelector(".toc")?.classList.add("active");
  }
};

const initTheme = function() {
  const prefersDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  const storedTheme = localStorage.getItem("theme-color");
  if (storedTheme) {
    if (storedTheme === "theme-dark") {
      document.querySelector(".theme-switcher")?.classList.add("active");
      document.querySelector(".toc")?.classList.add("active");
      document.documentElement.classList.add("dark-mode");
    }
  } else {
    if (prefersDarkMode) {
      localStorage.setItem("theme-color", "theme-dark");
      document.querySelector(".theme-switcher")?.classList.add("active");
      document.querySelector(".toc")?.classList.add("active");
      document.documentElement.classList.add("dark-mode");
    } else {
      localStorage.setItem("theme-color", "theme-light");
    }
  }
};

initTheme();
</script>

<script>
/* Arrow up */
// 通过位置判断是否显示
function onLoadHandle() {
  let viewportPositionTop =
    window.pageYOffset || document.documentElement.scrollTop;
  if (viewportPositionTop >= 200) {
    if (!$(".arrowup")) {
      arrowup.style.display = "inherit";
    } else {
      $(".arrowup").css("display", "inherit");
    }
  }
}
if (typeof jQuery === "undefined") {
  // Native JS
  let arrowup = document.querySelector(".arrowup");
  // 如果滚动距离达到一定值，显示按钮
  window.addEventListener("scroll", () => {
    arrowup.style.display = window.scrollY >= 200 ? "inherit" : "none";
  });
  // 在页面加载完成后执行的代码
  window.onload = function () {
    onLoadHandle();
  };
  // Back To The Top
  arrowup.addEventListener("click", function () {
    window.scrollTo({
      top: 0,
      behavior: "smooth"
    });
  });
} else {
  // jQuery
  $(window).scroll(function () {
    $(".arrowup").css("display", $(window).scrollTop() > 200 ? "inherit" : "none");
  });

  $(".arrowup").click(function () {
    $("html,body").animate({ scrollTop: 0 }, "slow");
  });

  $(document).ready(function () {
    onLoadHandle();
  });
}
</script>

<!-- Algolia DocSearch -->
<style>
.docsearchwrapper{
  display: none;
}
.DocSearch-Container{
  z-index: 9999999;
}
</style>

<!-- docsearch -->
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script>
function docSearchFuncMobile(){
    const DocSearchElement = document.querySelector(".DocSearch");
    DocSearchElement.click();
  }
</script>

<script type="text/javascript">
  docsearch({
    appId: "722DYFSYDR",
    apiKey: "5b7d4a36b43ac3d135ca6b83ac715f7e",
    indexName: "zairesinatraio",
    container: document.querySelector("#docsearch"),
    debug: false // Set debug to true if you want to inspect the modal
  });
</script>

<!-- 2023 => prismjs -->
<script src="https://cdn.jsdelivr.net/gh/Zairesinatra/GhostCDN@1.0.0/prism.js"></script>
<!-- Patch: additional supported languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-vim.min.js" integrity="sha512-P1MRK1H11qw68MAfAYVyjumLuurOQKO4wwcx4S2Nbbae9CndG92dkIXq34lsOeMFlWZoT7nVPgsOy3gepk93Bg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<!-- Activate Line Numbers in PrismJS -->
<script>
	window.addEventListener('DOMContentLoaded', (event) => {      
		document.querySelectorAll('pre[class*=language-]').forEach(function(node) {
			node.classList.add('line-numbers');
            node.style.border = 'solid #FFFFFF 1px'
		});
		Prism.highlightAll();
	});
</script>

<script>
/* Chrome Lighihouse Optimization */
window.addEventListener("DOMContentLoaded", (event) => {
  if (typeof jQuery === "undefined") {
    const searchBtnsForProps = document.querySelectorAll(".gh-search.gh-icon-btn");
    searchBtnsForProps.forEach((btn, i) => {
      btn.setAttribute("id", `GhostSearch${i}`);
      btn.setAttribute("aria-label", "Ghost Blog Search");
    });

    document.querySelector("button.gh-burger")
      .setAttribute("aria-label", "Ghost Blog Nav Menu");

    const siteLogo = document.querySelector(".site-logo");
    siteLogo.setAttribute("width", "120px");
    siteLogo.setAttribute("height", "120px");
  } else {
    $(".site-logo").attr({ width: "120px", height: "120px" });

    $(".gh-search.gh-icon-btn").each(function (index) {
      $(this).attr("id", `GhostSearch${index + 1}`);
      $(this).attr("aria-label", "Ghost Blog Search");
    });
  }
});
</script>

<!-- TOC -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.min.js"></script>
<script>
  tocbot.init({
    tocSelector: '.toc',
    contentSelector: '.gh-content',
    hasInnerContainers: true
  });
</script>
<script>
function tocHandle() {
  var tc = document.querySelector(".toc-container");
  var ah = document.querySelector(".article-header");
  
  if (tc && ah) {
    var tcch = tc.clientHeight;
    var ahch = ah.clientHeight;
    var isTocSticky = false;

    function handleScroll() {
      if (document.body.clientWidth > 1170) {
        var scrollY = window.pageYOffset || document.documentElement.scrollTop;
        var wih = window.innerHeight;

        if (scrollY >= wih + tcch + ahch && !isTocSticky) {
          tc.style.position = "sticky";
          tc.style.position = "-webkit-sticky";
          tc.style.top = "120px";
          tc.style.marginLeft = "800px";
          tc.style.minWidth = "260px";
          isTocSticky = true;
        }
        
        if (scrollY < tcch + ahch - 10 && isTocSticky) {
          tc.style.position = "";
          tc.style.top = "";
          tc.style.marginLeft = "";
          isTocSticky = false;
        }
      }
    }

    // 避免在每个滚动事件触发时都执行回调函数
    window.addEventListener("scroll", function () {
      requestAnimationFrame(handleScroll);
    });
  }
}

window.addEventListener("DOMContentLoaded", tocHandle);
</script>

</body>
</html>
